#!/bin/bash

# –ü–†–û–°–¢–û–ï –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö 32 –∏–∑–º–µ–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ –≥–æ—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã

DOC="../../../FM_DOCUMENTS/FM-LS-PROFIT-v1.2.1-DRAFT.docx"
AUTHOR="–®–∞—Ö–æ–≤—Å–∫–∏–π –ê.–°."

echo "========================================"
echo "–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ 32 –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫ FM-LS-PROFIT"
echo "========================================"
echo ""

# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø
cp "$DOC" "${DOC%.docx}.bak"
echo "‚úÖ –ë—ç–∫–∞–ø —Å–æ–∑–¥–∞–Ω"
echo ""

# =============================================================================
# –ü–†–û–°–¢–´–ï –¢–ï–ö–°–¢–û–í–´–ï –ó–ê–ú–ï–ù–´ (—á–µ—Ä–µ–∑ replace)
# =============================================================================

echo "üîÑ –¢–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–º–µ–Ω—ã..."

# MEDIUM-008: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏–∏
dotnet run --project DocxTools.csproj -- replace "$DOC" " —Å–º–µ—Ç" " –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–º–µ—Ç" --tracked --author "$AUTHOR" 2>&1 | grep -v "warning NU"

# LOW-003: –ü—Ä–∞–≤–∏–ª–æ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è "—Ä–µ–Ω—Ç."
dotnet run --project DocxTools.csproj -- replace "$DOC" "—Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –æ—Å—Ç–∞—Ç–∫–∞" "—Ä–µ–Ω—Ç. –æ—Å—Ç–∞—Ç–∫–∞" --tracked --author "$AUTHOR" 2>&1 | grep -v "warning NU"

echo ""
echo "========================================"
echo "‚úÖ 2 —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–º–µ–Ω—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã"
echo "========================================"
echo ""
echo "üìù –û—Å—Ç–∞–ª–æ—Å—å 30 –∏–∑–º–µ–Ω–µ–Ω–∏–π"
echo ""
echo "–î–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∏—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—É comment:"
echo ""
echo "–ü—Ä–∏–º–µ—Ä:"
echo "  dotnet run -- comment \"$DOC\" \"–ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏\" \"CRIT-002: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ù–ü–°–°=NULL\" --author \"$AUTHOR\""
echo ""
echo "–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö 30 –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ñ–∞–π–ª–µ:"
echo "  FM_DOCUMENTS/FM-LS-PROFIT-v1.2.1-APPLICATION-REPORT.md"
echo ""
