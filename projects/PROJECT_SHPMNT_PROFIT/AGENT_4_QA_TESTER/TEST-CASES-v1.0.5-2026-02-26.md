# Тест-план FM-LS-PROFIT v1.0.5

**Дата:** 26.02.2026
**Версия ФМ:** 1.0.5 (Confluence page 83951683)
**Платформа:** 1С:Управление Торговлей, редакция 10.2 / 1С:Предприятие 8.3
**Режим работы:** Обычное приложение (толстый клиент, обычные формы)
**Область:** Полное покрытие — требования v1.0.4 (регрессия) + изменения v1.0.5 (платформа) + риски платформы

> **Критически важно:** Средства автоматизированного UI-тестирования (Vanessa Automation, TestClient) работают только с управляемыми формами. 1С:УТ 10.2 использует обычные формы — автоматизированное UI-тестирование **невозможно**. Все UI-тесты выполняются **вручную**. Серверная бизнес-логика тестируется через xUnitFor1C.

---

## Метрики покрытия

| Категория | Всего объектов | Покрыто тестами | % |
|-----------|----------------|-----------------|---|
| Бизнес-правила (LS-BR) | 18 ключевых | 18 | 100% |
| Функциональные (LS-FR) | 12 ключевых | 12 | 100% |
| Новые требования v1.0.5 (платформа) | 8 | 8 | 100% |
| Риски платформы (прекращение поддержки, совместимость 8.3) | 5 | 5 | 100% |
| Манипуляции / обход контроля | 8 | 8 | 100% |
| Интеграции | 3 | 3 | 100% |

**Всего тест-кейсов:** 80
- Позитивных (POS): 20
- Негативных (NEG): 20
- Граничных (EDGE): 18
- Манипуляций (MANIP): 8
- Интеграционных (INT): 5
- Производительность/нагрузка (PERF): 5
- Платформенных рисков (PLAT): 4

**Способ выполнения:**
- Ручные (UI): 68 тест-кейсов — все UI-взаимодействия через интерфейс толстого клиента
- xUnitFor1C (серверная логика): 12 тест-кейсов — расчёты, регистры, модули объектов

---

## Изменения относительно v1.0.4

| # | Тест-кейс | Изменение | Причина |
|---|-----------|-----------|---------|
| 1 | TC-004 | Убрана двойственность критерия | CRIT-001 закрыт: таймаут = 5 мин |
| 2 | TC-063..TC-066 | Заменены на ручные сценарии | Gherkin/Vanessa недоступны для обычных форм |
| 3 | TC-067 | Обновлён: ожидаемый результат = 64 | HIGH-001 закрыт: P1 = 64 требования |
| 4 | TC-068 | Обновлён: ожидаемый результат определён | GAP-02 закрыт: блокировка ЛС + фиксация НПСС |
| 5 | TC-073..TC-080 | Новые | Риски и ограничения платформы УТ 10.2 |
| 6 | Все UI-шаги | Добавлен способ проверки на форме | Обычные формы: надписи, кнопки, модальные диалоги |

---

## Выявленные риски (непротестируемые / трудно тестируемые)

| # | Требование | Проблема | Статус |
|---|------------|----------|--------|
| 1 | Регрессионное тестирование | 80 тест-кейсов выполняются вручную. При каждом обновлении платформы 8.3 — полный прогон (2-3 рабочих дня) | Управляемый риск |
| 2 | Автоматизация UI | Невозможна для обычных форм УТ 10.2. Vanessa Automation и TestClient не поддерживают | Принятый риск |
| 3 | Совместимость с новыми версиями 8.3 | Поведение ЭлементыФормы при обновлении платформы непредсказуемо | PLAT-тесты TC-077..TC-078 |

---

## Тест-кейсы

---

### Модуль 1: Расчёт рентабельности и формулы

---

#### TC-001: Базовый расчёт рентабельности позиции

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.3 — Рентабельность = (Цена - НПСС) / Цена x 100% |
| **xUnit** | КонтрольРентабельности_Тест.ПроверитьФормулу() |

**Предусловия:**
- ЛС с плановой рентабельностью 35%
- Позиция: Цена = 1 000 руб., НПСС = 650 руб.

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать Заказ клиента, выбрать ЛС, добавить позицию | Заказ создан, ЛС привязана | Форма Заказа открыта, реквизит «ЛокальнаяСмета» заполнен |
| 2 | Записать Заказ (F2 или кнопка «Записать») | Расчёт рентабельности запущен | Надпись «НадписьРентабельность» обновляется: «Рентабельность заказа: 35,00%» |
| 3 | Проверить рентабельность позиции | (1 000 - 650) / 1 000 * 100% = 35,00% | В табличной части Заказа колонка «РентабельностьПозиции» = 35,00 |
| 4 | Убедиться, что согласование не требуется | Статус Заказа = «Согласован системой» | Надпись «НадписьСтатус» на форме: «Согласован системой» |

---

#### TC-002: Формула «Выручка отгруженного» — нетто с учётом возвратов

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) + xUnitFor1C |
| **Требование** | п. 3.5 — Выручка отгруженного = SUM(РТУ) - SUM(Возвраты 60д) |
| **xUnit** | КонтрольРентабельности_Тест.ПроверитьВыручкуНетто() |

**Предусловия:**
- ЛС с двумя отгрузками: РТУ-1 на 100 000 руб., РТУ-2 на 50 000 руб.
- Возврат по РТУ-1 на 20 000 руб. в течение 60 дней

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Провести РТУ-1 и РТУ-2 | Накопленная выручка = 150 000 руб. | Отчёт «РентабельностьЛС»: столбец «ВыручкаОтгруженного» = 150 000 |
| 2 | Провести Возврат по РТУ-1 (в течение 60 дней) | Накопленная выручка пересчитана = 130 000 руб. | Тот же отчёт: 100 000 + 50 000 - 20 000 = 130 000 |
| 3 | Создать Заказ-3 и записать | Рентабельность рассчитана от нетто 130 000 руб. | Надпись «НадписьНакопленнаяПлюсЗаказ» отражает корректный расчёт |

---

#### TC-003: Блокировка позиции при НПСС=0

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Негативный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.3 — при НПСС=0/NULL позиция блокируется |

**Предусловия:**
- ЛС с позицией, у которой НПСС = 0

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать Заказ, добавить позицию с НПСС=0 | Позиция заблокирована | Модальный диалог «Предупреждение»: «НПСС позиции [Номенклатура] не заполнена. Позиция заблокирована» |
| 2 | Проверить уведомление финслужбе | Уведомление записано | Регистр «УведомленияПользователей»: запись с номенклатурой и номером ЛС |
| 3 | Провести Заказ с другими позициями той же ЛС | Заказ создаётся без блокированной позиции | Заказ записан, позиция с НПСС=0 отсутствует в табличной части |

---

#### TC-004: Таймаут блокировки LS-BR-035 — 5 минут (закрыт CRIT-001)

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Граничный |
| **Способ** | Ручной (UI) |
| **Требование** | LS-BR-035, п. 3.15 — таймаут блокировки = 5 мин. CRIT-001 закрыт в v1.0.5 |

**Предусловия:**
- Менеджер-1 начал создание Заказа по ЛС (ЛС заблокирована)
- Менеджер-2 пытается создать Заказ по той же ЛС
- Часы на сервере синхронизированы

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Менеджер-1 открывает форму Заказа и выбирает ЛС | ЛС заблокирована | Запись в РегистрСведений.БлокировкиЛС: ВремяИстечения = ТекущаяДата() + 5*60 |
| 2 | Менеджер-2 пытается выбрать ту же ЛС | Модальный диалог с информацией | «Предупреждение»: «Локальная смета редактируется: [ФИО Менеджера-1] до [ЧЧ:ММ]» |
| 3 | Ожидать 5 минут неактивности Менеджера-1 (засечь время по системным часам) | Блокировка снята автоматически | Регламентное задание «ОчисткаБлокировок» (расписание каждые 1 мин) удалило запись. Менеджер-2 может открыть ЛС |
| 4 | Проверить уведомление Менеджера-1 через 3 минуты | Предупреждение о приближении таймаута | Модальный диалог: «Завершите редактирование в течение 2 минут» (через 3 мин = за 2 мин до истечения) |
| 5 | Администратор снимает блокировку вручную | Блокировка снята | Обработка «АктивныеБлокировкиЛС»: запись удалена, Менеджер-2 может открыть ЛС |

**Примечание:** Константа «ТаймаутБлокировкиЛС» = 5. CRIT-001 закрыт в ФМ v1.0.5. Ожидаемый результат однозначен.

---

#### TC-005: Округление отклонения до сравнения с границами

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Граничный |
| **Способ** | xUnitFor1C + Ручной (UI) |
| **Требование** | п. 3.15 — округление до 2 знаков до сравнения с границами |
| **xUnit** | КонтрольРентабельности_Тест.ПроверитьОкругление() |

**Тестовые данные:**

| Фактическое отклонение | После округления | Ожидаемый согласующий |
|------------------------|-----------------|----------------------|
| 15.005% | 15.01% | ДП |
| 15.004% | 15.00% | РБЮ |
| 14.995% | 15.00% | РБЮ |
| 25.005% | 25.01% | ГД |
| 25.004% | 25.00% | ДП |
| 0.994% | 0.99% | Согласование не требуется |
| 0.995% | 1.00% | РБЮ |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать Заказ с отклонением 15.005% | Согласование уровня ДП | Надпись «НадписьТребуемыйУровень» = «ДП» |
| 2 | Создать Заказ с отклонением 15.004% | Согласование уровня РБЮ | Надпись «НадписьТребуемыйУровень» = «РБЮ» |
| 3 | Создать Заказ с отклонением 0.994% | Согласование не требуется | Статус = «Согласован системой» |
| 4 | Создать Заказ с отклонением 0.995% | Согласование уровня РБЮ | Надпись «НадписьТребуемыйУровень» = «РБЮ» |


---

### Модуль 2: Матрица согласования

---

#### TC-006: Позитивный сценарий — согласование РБЮ (отклонение 7 п.п.)

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.4 — 1,00-15,00 п.п. → РБЮ |

**Предусловия:** ЛС план 35%, (Накопленная + Заказ) = 28%. Отклонение = 7 п.п.

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать и записать Заказ с отклонением 7 п.п. | Статус «На согласовании» | Надпись «НадписьСтатус» = «На согласовании»; реквизит «СтатусКонтроля» = НаСогласовании |
| 2 | Проверить задачу в ELMA для РБЮ | Задача создана в ELMA | В ELMA: задача на имя РБЮ, номер Заказа, сумма, отклонение 7 п.п. |
| 3 | РБЮ согласует Заказ в ELMA | Заказ переходит в статус «Согласован» | Обратный вызов от ELMA в 1С:УТ; надпись «НадписьСтатус» = «Согласован» |
| 4 | Проверить уведомление менеджеру | Запись в регистре уведомлений | РегистрСведений.УведомленияПользователей: запись для менеджера с указанием решения |

---

#### TC-007: Автоэскалация РБЮ → Директор ДРП после SLA P1

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) + регламентное задание |
| **Требование** | п. 3.6 — РБЮ 4ч → Директор ДРП; для P1 (сумма > 500 т.р.) |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать Заказ P1 (> 500 т.р.) с отклонением 7 п.п. | Задача РБЮ в ELMA с SLA 4 ч | Заявка на согласование: реквизит «SLAЧасов» = 4; «ДатаДедлайна» = ТекущаяДата() + 4ч рабочих |
| 2 | Подождать 4 рабочих часа без ответа РБЮ (через настройку SLA в тестовой базе) | Задача эскалирована Директору ДРП | Регламентное задание «ЭскалацияSLA»: в ELMA создана новая задача для Директора ДРП |
| 3 | Проверить уведомление РБЮ об эскалации | РБЮ получил уведомление | РегистрСведений.УведомленияПользователей: запись об эскалации для РБЮ |
| 4 | Подождать ещё 4 часа (Директор ДРП не ответил) | Задача эскалируется ДП | Суммарно 8 часов — задача у ДП |

---

#### TC-008: Автоотказ ГД через 48 часов

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) + регламентное задание |
| **Требование** | п. 3.5.2 — автоотказ ГД через 48ч, уведомление ФД |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать Заказ с отклонением > 25 п.п. | Задача ГД в ELMA с SLA 24 ч | Заявка: «SLAЧасов» = 24; «ДатаДедлайна» соответствует |
| 2 | Подождать 48 рабочих часов без ответа ГД | Статус = «Превышение SLA», автоотказ | Регламентное задание «АвтоотказГД»: Заказ переведён в статус «Отклонён», создан черновик |
| 3 | Проверить уведомление ФД | ФД получил уведомление с пометкой «Требует эскалации» | РегистрСведений.УведомленияПользователей: запись для ФД |
| 4 | ФД принимает решение | ФД может одобрить, направить ГД повторно или подтвердить отказ | Форма «РабочееМестоФД»: кнопки решения активны |
| 5 | Менеджер повторно подаёт Заказ | Заказ принят к повторному рассмотрению | Реквизит «ПовторнаяПодача» = Истина; «НомерПопытки» увеличен |

---

#### TC-009: Автосогласование системой при улучшении рентабельности

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.5.3 — автосогласование при улучшении < 1 п.п. во время ожидания |

**Предусловия:** Заказ ждёт согласования РБЮ с отклонением 3 п.п. По той же ЛС отгружен Заказ с высокой маржой.

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Заказ-1 находится «На согласовании» (отклонение 3 п.п.) | Задача у РБЮ в ELMA | Заявка: статус «ВОчереди» в ELMA |
| 2 | Провести Заказ-2 по той же ЛС с маржой +15 п.п. | Накопленная рентабельность улучшается | Регистр «РентабельностьОтгруженного»: новая запись по ЛС |
| 3 | Регламентное задание пересчитывает (Накопл. + Заказ-1) | (Накопл. + Заказ-1) < 1 п.п. от плана | Регламентное задание «ПересчётАктивныхЗаказов»: срабатывает |
| 4 | Проверить статус Заказа-1 | Статус = «Согласован» | Надпись «НадписьСтатус» = «Согласован системой»; задача в ELMA закрыта |

---

#### TC-010: Исключение дефолта ГД — условие «на момент наступления»

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Граничный |
| **Способ** | Ручной (UI) + регламентное задание |
| **Требование** | п. 3.6 — исключение автоотказа ГД, если на момент 48ч (Накоп. + Заказ) >= плановой |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Заказ-1 находится «На согласовании» у ГД (36 ч.) | Статус «На согласовании» | Заявка: ДатаДедлайна ещё не истекла |
| 2 | Провести Заказ-2 по той же ЛС с маржой +40 п.п. | Накопленная рентабельность >= плановой | Регистр «РентабельностьОтгруженного» обновлён |
| 3 | Дождаться 48 часов для Заказа-1 | Система проверяет условие исключения | Регламентное задание «АвтоотказГД»: проверка условия исключения |
| 4 | Проверить, что Заказ-1 НЕ получил автоотказ | Статус = «Согласован автоматически» | Надпись «НадписьСтатус» = «Согласован»; в комментарии — ссылка на условие исключения |

---

#### TC-011: SLA для заказов до 100 т.р. — ускоренное согласование

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Граничный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.4.1 — фиксированные SLA <100 т.р.: РБЮ 2ч, ДП 4ч, ГД 12ч |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать Заказ < 100 т.р. с отклонением 7 п.п. | Задача РБЮ с SLA 2 часа | Заявка: реквизит «SLAЧасов» = 2 |
| 2 | Подождать 2 ч. без ответа | Автоэскалация Директору ДРП | Через 4 ч. суммарно — двойной SLA применён |
| 3 | Создать Заказ точно 100 000 руб. с отклонением 7 п.п. | SLA по P1/P2 (не ускоренный) | Заявка: «SLAЧасов» = 4 (P1) — граница включительно |
| 4 | Создать Заказ 99 999 руб. с отклонением 7 п.п. | Ускоренный SLA (2ч РБЮ) | Заявка: «SLAЧасов» = 2 |

---

### Модуль 3: Автосогласование и агрегированные лимиты

---

#### TC-012: Автосогласование в пределах лимита

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) + xUnitFor1C |
| **Требование** | п. 3.5 — автосогласование при отклонении < 1 п.п. |
| **xUnit** | ЛимитыАвтосогласования_Тест.ПроверитьАвтосогласование() |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать Заказ с отклонением 0.5 п.п., убыток 3 000 руб. | Автосогласование | Статус сразу «Согласован системой»; задача в ELMA не создана |
| 2 | Создать второй Заказ с отклонением 0.5 п.п., убыток 1 500 руб. | Автосогласование (суммарно 4 500 < 5 000) | Статус = «Согласован системой» |
| 3 | Третий Заказ, убыток 600 руб. (суммарно 5 100 > 5 000) | Направлен на стандартное согласование | Задача ELMA создана; надпись «НадписьСтатус» = «На согласовании» |

---

#### TC-013: Агрегированный лимит менеджера — 20 000 руб./день

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Граничный |
| **Способ** | Ручной (UI) + xUnitFor1C |
| **Требование** | п. 3.7 — агрег. лимит менеджера 20 000 руб./день |
| **xUnit** | ЛимитыАвтосогласования_Тест.ПроверитьЛимитМенеджера() |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Провести экстренные: 8 000 + 7 000 руб. убытка | Оба согласованы (накопл. 15 000 < 20 000) | РегистрНакопления.ЛимитыАвтосогласования: остаток 5 000 руб. |
| 2 | Третье экстренное согласование: убыток 6 000 руб. | Модальный диалог: «Превышен агрегированный лимит менеджера (20 000 руб./день)» | «Предупреждение» с указанием лимита; Заказ направлен на стандартное согласование в ELMA |
| 3 | Убедиться, что Заказ направлен на стандартное согласование | Задача в ELMA создана | Заявка: ТипСогласования = «Стандартное» |
| 4 | В 00:00 следующего дня — новое экстренное | Лимит сброшен | Регистр: остаток = 20 000 (новый день) |

---

#### TC-014: Агрегированный лимит БЮ — 100 000 руб./день

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Граничный |
| **Способ** | Ручной (UI) + xUnitFor1C |
| **Требование** | п. 3.7 — агрег. лимит БЮ 100 000 руб./день |
| **xUnit** | ЛимитыАвтосогласования_Тест.ПроверитьЛимитБЮ() |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | 5 менеджеров одного БЮ совершают экстренные по 18 000 руб. | Все успешны; накопл. по БЮ = 90 000 | РегистрНакопления.ЛимитыАвтосогласования: ресурс «СуммаБЮ» = 90 000 |
| 2 | Шестой менеджер того же БЮ, убыток 12 000 | Стандартное согласование | «Предупреждение»: «Превышен агрегированный лимит БЮ (100 000 руб./день)» |
| 3 | Другой БЮ — проверить независимость | Менеджеры других БЮ не ограничены | Регистр: «СуммаБЮ» для другого БЮ = 0 |

---

#### TC-015: Экстренное согласование — лимит 3/мес и 10/мес в пиковые периоды

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Граничный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.7 — 3/мес на менеджера, 5/мес на контрагента; пик — до 10 |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Вне пика: 3-е экстренное согласование менеджера | Согласование доступно | Кнопка «ЭкстренноеСогласование» активна |
| 2 | Вне пика: 4-е экстренное | Заблокировано | «Предупреждение»: «Исчерпан лимит экстренных согласований (3/мес)» |
| 3 | В пиковый период: 10-е экстренное | Доступно (10 <= 10) | Кнопка активна |
| 4 | В пиковый период: 11-е экстренное | Заблокировано | «Предупреждение»: «Исчерпан лимит (10/мес в пиковый период)» |

---

#### TC-016: Автоконтроль постфактум экстренного согласования

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) + регламентное задание |
| **Требование** | п. 3.7 — постфактум в течение 24ч; для стратегических клиентов 48ч |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Менеджер проводит экстренное согласование | Заказ отгружен | ТипСогласования = «Постфактум»; таймер 24ч запущен |
| 2 | В течение 24ч согласующий не подтверждает | Уведомление согласующему и менеджеру | Регистр «УведомленияПользователей»: записи для обоих |
| 3 | По истечении 48ч (стратегический клиент) без подтверждения | Уведомление руководству | Отчёт ФД: пометка «Постфактум без подтверждения» |
| 4 | Согласующий подтверждает постфактум | Статус нормализован | Заявка: Решение = «Одобрено»; пометка снята |


---

### Модуль 4: Лимит итераций корректировки цены

---

#### TC-017: Успешная корректировка цены за 1 итерацию

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.5.1 — лимит 5 итераций; все в аудите |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Заказ на согласовании; согласующий вводит рекомендуемую цену в ELMA | Цена передана менеджеру | РегистрСведений.ИтерацииКорректировкиЦены: запись номер 1 |
| 2 | Менеджер вносит рекомендуемую цену в форму Заказа | Отклонение стало < 1 п.п. | Надпись «НадписьОтклонение» обновлена; пересчёт рентабельности выполнен |
| 3 | Система автоматически согласовывает Заказ | Статус «Согласован» | Надпись «НадписьСтатус» = «Согласован»; итерация 1 зафиксирована |

---

#### TC-018: Автоотклонение после 5-й итерации корректировки

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Негативный |
| **Способ** | Ручной (UI) + xUnitFor1C |
| **Требование** | п. 3.5.1 — после 5-й итерации автоматическое отклонение |
| **xUnit** | ИтерацииКорректировки_Тест.ПроверитьЛимит5() |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Провести 4 итерации корректировки (ни одна не выводит в норму) | 4 итерации в регистре | РегистрСведений.ИтерацииКорректировкиЦены: 4 записи |
| 2 | 5-я итерация: менеджер вносит цену, которая всё равно не проходит порог | 5-я итерация зафиксирована | Регистр: 5 записей |
| 3 | Попытка 6-й итерации | Автоматическое отклонение | «Предупреждение»: «Превышен лимит итераций корректировки цены (5 из 5). Заказ переведён в черновик» |
| 4 | Проверить журнал аудита | Все 5 итераций зафиксированы | Регистр: 5 записей с датой/временем и ФИО инициатора; реквизит «НомерИтерацииКорректировки» = 5 |

---

#### TC-019: Менеджер отклоняет рекомендацию согласующего по цене

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.5.1 — менеджер может отклонить рекомендацию |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Согласующий указывает рекомендуемую цену | Менеджер видит уведомление | Надпись на форме Заказа: «Рекомендована цена: [X] руб.»; кнопки «Принять»/«Отклонить» активны |
| 2 | Менеджер нажимает кнопку «Отклонить рекомендацию» | Итерация засчитана | Регистр: запись с Результат = «Отклонено»; счётчик = 1 из 5 |
| 3 | Заказ возвращается на согласование с исходной ценой | Статус = «На согласовании» | Надпись «НадписьСтатус» = «На согласовании»; реквизит «НомерИтерацииКорректировки» = 1 |

---

#### TC-020: EDI-заказ — только «одобрить» или «отклонить»

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Негативный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.5.1 — для EDI кнопка «Согласовать с корректировкой цены» недоступна |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | EDI-заказ поступает с отклонением рентабельности | Заказ направлен на согласование | Реквизит «ИсточникЗаказа» = «EDI» |
| 2 | Согласующий открывает форму согласования EDI-заказа | Доступны только «Одобрить» и «Отклонить» | Кнопка «КнопкаКорректировкаЦены» имеет свойство Видимость = Ложь (проверить через ЭлементыФормы) |
| 3 | Попытаться нажать кнопку программным путём | Система блокирует | «Предупреждение»: «Корректировка цены EDI-заказа недоступна» |

---

### Модуль 5: Перекрёстный контроль шкал

---

#### TC-021: Повторная проверка при снижении плана ЛС

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.15 — при изменении плана ЛС все Заказы «На согласовании» проходят повторную проверку |

**Предусловия:** ЛС план 35%, Заказ-1 на согласовании РБЮ (отклонение 7 п.п. = 28% факт).

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Изменить плановую рентабельность ЛС: 35% → 25% | Перекрёстный контроль запущен | Регламентное задание «ПерекрёстныйКонтрольШкал»: срабатывает при изменении ЛС |
| 2 | Система пересчитывает отклонение Заказа-1 | Новое отклонение: 25% - 28% = -3 п.п. (Заказ лучше плана) | Реквизит «Отклонение» Заказа-1 = -3; ТребуемыйУровень = Пусто |
| 3 | Заказ-1 автоматически согласован | Статус = «Согласован» | Надпись «НадписьСтатус» = «Согласован системой» |

---

#### TC-022: Повышение уровня согласования при изменении плана ЛС

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Негативный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.15 — если уровень согласования по новому плану выше — Заказ на повторное согласование |

**Предусловия:** ЛС план 25%, Заказ-1 на согласовании РБЮ (отклонение 7 п.п., факт 18%).

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Изменить план ЛС: 25% → 45% | Перекрёстный контроль запущен | Регламентное задание срабатывает |
| 2 | Система пересчитывает отклонение Заказа-1 | 45% - 28% = 17 п.п. → уровень ДП | Заявка: УровеньСогласования изменён с «РБЮ» на «ДП» |
| 3 | Заказ-1 отправлен на повторное согласование к ДП | Статус = «На согласовании» (ДП) | Уведомление шаблона: «Заказ N[...] возвращён на согласование. Причина: изменение плана ЛС с 25% до 45%. Новый уровень: ДП. SLA: 8ч» |
| 4 | РБЮ получает уведомление об аннулировании | Задача РБЮ закрыта | Регистр «УведомленияПользователей»: запись для РБЮ: «Задача аннулирована» |

---

#### TC-023: Перекрёстный контроль «Согласованных» заказов

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Негативный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.15 — «Согласованные» Заказы также проходят повторную проверку |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Заказ-2 в статусе «Согласован» (не передан на склад). Изменить план ЛС: 25% → 45% | Перекрёстный контроль для «Согласованных» | Заказ-2: реквизит «ПереданНаСклад» = Ложь — подлежит контролю |
| 2 | Система пересчитывает: новое отклонение 17 п.п. > 15 п.п. | Требуется уровень ДП | Реквизит «ТребуемыйУровень» = «ДП» |
| 3 | Заказ-2 переходит в «На повторном согласовании» | Статус изменён | Надпись «НадписьСтатус» = «На согласовании» |
| 4 | Передача в WMS заблокирована | Попытка открыть форму отгрузки — модальный диалог | «Предупреждение»: «Передача в WMS невозможна: требуется повторное согласование» |

---

#### TC-024: Точка невозврата — перекрёстный контроль не применяется

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) + xUnitFor1C |
| **Требование** | п. 3.15 — после установки «ПереданНаСклад» Заказ не подлежит повторному согласованию |
| **xUnit** | ПерекрёстныйКонтроль_Тест.ПроверитьТочкуНевозврата() |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Заказ-3 передан на склад («ПереданНаСклад» = Истина) | Заказ в точке невозврата | Реквизит «ПереданНаСклад» = Истина |
| 2 | Изменить план ЛС | Перекрёстный контроль запущен для других Заказов | Регламентное задание обрабатывает остальные Заказы |
| 3 | Проверить, что Заказ-3 НЕ затронут | Заказ-3 без изменений | Статус Заказа-3 не изменён; в журнале задания — фильтр «ПереданНаСклад = Ложь» |

---

### Модуль 6: ELMA Fallback (резервный режим)

---

#### TC-025: ELMA fallback — автосогласование при отклонении до 5 п.п.

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.13 — при недоступности ELMA: до 5 п.п. — автосогласование |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Имитировать недоступность ELMA (остановить сервис или указать неверный адрес в константе) | 1С не может создать задачу в ELMA | HTTP-запрос возвращает ошибку; система переходит в резервный режим |
| 2 | Создать Заказ с отклонением 3 п.п. | Заказ автосогласован с пометкой «Резервный режим» | Надпись «НадписьРежимСогласования» = «Резервный режим»; Заявка: РежимСогласования = «Резервный» |
| 3 | Проверить уведомление IT-директора | Уведомление записано | Регистр «УведомленияПользователей»: запись для IT-директора об активации резервного режима |
| 4 | Проверить журнал | Все операции зафиксированы | РегистрСведений.ОчередьРезервногоРежима: запись со статусом «Автосогласовано» |

---

#### TC-026: ELMA fallback — очередь FIFO при отклонении свыше 5 п.п.

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.13 — при недоступности ELMA: свыше 5 п.п. — очередь FIFO |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | ELMA недоступна. Создать 3 Заказа с отклонением > 5 п.п. в порядке А, Б, В | Все 3 в очереди ожидания FIFO | Регистр «ОчередьРезервногоРежима»: 3 записи со статусом «ВОчереди»; ДатаПостановки А < Б < В |
| 2 | Менеджер видит сообщение об очереди | «Предупреждение»: «ELMA временно недоступна. Заказ поставлен в очередь ожидания» | Модальный диалог при записи каждого Заказа |
| 3 | ELMA восстановлена | Задачи создаются в порядке А, Б, В | Регламентное задание «ОбработкаОчередиELMA»: задачи отправлены по FIFO; статусы = «ОтправленоВЕлму» |
| 4 | Проверить уведомление согласующих | После восстановления уведомлены | Регистр «УведомленияПользователей»: записи для согласующих о pending-задачах |

---

#### TC-027: ELMA недоступна > 4 часов — эскалация IT-директору

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Негативный |
| **Способ** | Ручной (UI) + регламентное задание |
| **Требование** | п. 3.13 — при недоступности ELMA > 4 часов — эскалация IT-директору |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | ELMA недоступна; прошло 4 рабочих часа | Регламентное задание «МониторингELMA» обнаруживает превышение | Журнал регламентного задания: запись о сбое длительностью > 4ч |
| 2 | IT-директор получает эскалацию | Уведомление с деталями сбоя | Регистр «УведомленияПользователей»: запись для IT-директора |
| 3 | Система продолжает работу в резервном режиме | Операции до 5 п.п. автосогласуются | Новые Заказы до 5 п.п. — статус «Согласован» с пометкой «Резервный режим» |

---

### Модуль 7: Нагрузка согласующих — два порога

---

#### TC-028: Порог 30 задач — автоматический перелив на заместителя

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Граничный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 5 — при > 30 задач → перелив на заместителя |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать 30 Заказов на согласовании у РБЮ | 30 задач — перелив ещё не активен | Регистр «НагрузкаСогласующих»: ЗадачВОчереди = 30; ПереливАктивен = Ложь |
| 2 | Создать 31-й Заказ у того же РБЮ | Задача автоматически перенаправлена заместителю | Регистр: ПереливАктивен = Истина; задача маршрутизирована заместителю |
| 3 | На форме рабочего места согласующего | Надпись «В очереди: 31/30» красным | Надпись «НадписьЗадачВОчереди»: ЦветТекста = красный (RGB 255,0,0); заголовок = «В очереди: 31/30» |
| 4 | Проверить, что заместитель назначен из справочника ELMA | Заместитель — из «ДежурныеСогласующие» | Заявка: Согласующий = Заместитель из справочника |

---

#### TC-029: Порог 50 задач — организационный сигнал

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Граничный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 5 — при > 50 задач/день — назначить дополнительного согласующего |

**Примечание:** Порог 30 = автоматический оперативный перелив. Порог 50 = организационный лимит.

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | РБЮ получает 50 задач за день | Надпись «За день: 50/50» | Надпись «НадписьЗадачЗаДень»: ЦветТекста = оранжевый; значение = «50/50» |
| 2 | 51-я задача за день | Надпись красным; ДопСогласующийНазначен = Ложь (сигнал ДП) | Надпись «НадписьЗадачЗаДень» ЦветТекста = красный; Регистр: ЗадачЗаДень = 51 |
| 3 | ДП получает уведомление о перегрузке | Уведомление: «[ФИО]: 51 задача/день, превышен порог 50» | Регистр «УведомленияПользователей»: запись для ДП |
| 4 | Убедиться: порог 30 (перелив) и 50 (оргрешение) — разные механизмы | При 31 задаче ПереливАктивен = Истина; при 51 задаче — уведомление ДП | Регистр «НагрузкаСогласующих»: реквизиты ПереливАктивен и ДопСогласующийНазначен независимы |

---

#### TC-030: Назначение заместителя при отсутствии согласующего > 4 часов

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.6 — при отсутствии согласующего > 4ч — переназначение заместителю |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Отметить РБЮ отсутствующим в ELMA | Задачи перенаправляются заместителю | Справочник «ДежурныеСогласующие»: ДоступенОнлайн = Ложь |
| 2 | Создать новый Заказ, требующий РБЮ | Задача попадает к заместителю | Заявка: Согласующий = Заместитель |
| 3 | Снять статус «отсутствует» | Новые задачи снова идут к РБЮ | Следующий Заказ: задача маршрутизирована к РБЮ |


---

### Модуль 8: Отчёты пилота

---

#### TC-031: LS-RPT-072 — два порога нагрузки в одном отчёте

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | LS-RPT-072 — отчёт нагрузки согласующих; порог перелива 30 и лимит 50 |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Открыть отчёт LS-RPT-072 | Отчёт сформирован | Таблица: колонки «Задач в очереди / 30» и «Задач за день / 50» |
| 2 | Найти согласующего с 35 задачами в очереди | Значение выделено (перелив активен) | Колонка «Автоперелив» = «Да»; значение 35/30 |
| 3 | Найти согласующего с 55 задачами за день | Значение красным | Колонка «Задач за день» = 55/50 (превышен лимит 50) |
| 4 | Проверить наличие обоих порогов в отчёте | Легенда/заголовки содержат оба порога | В шапке отчёта: «Порог перелива: 30», «Порог назначения: 50» — DEFECT если отсутствует один |

---

#### TC-032: LS-RPT-073 — базовый замер KPI перед пилотом

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | LS-RPT-073 — замер KPI: 100+ ЛС за 6 мес. |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Открыть LS-RPT-073 при наличии 100+ закрытых ЛС | Отчёт сформирован | Показатели: % ЛС ниже плановой рентабельности, средняя потеря маржи/ЛС |
| 2 | Запустить при < 100 ЛС | Предупреждение | «Предупреждение»: «Недостаточно данных для базового замера (N < 100 ЛС)» |

---

#### TC-033: LS-RPT-074 — промежуточный отчёт пилота

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | LS-RPT-074 — если доля игнорированных предупреждений > 50%, рабочая группа за 5 р.д. |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Открыть LS-RPT-074 через 1 мес. пилота | Показатели: кол-во предупреждений, игнорированных, доля | Отчёт открывается, данные по всем трём показателям |
| 2 | Смоделировать 60% игнорирования | Уведомление о созыве рабочей группы за 5 р.д. | Регистр «УведомленияПользователей»: запись для рабочей группы |
| 3 | Смоделировать 40% игнорирования | Уведомление не создаётся | Регистр: новых записей нет |

---

### Модуль 9: Автотриггеры НПСС (LS-BR-075)

---

#### TC-034: Автотриггер пересчёта НПСС при курсе ЦБ > 5% за 7 дней

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) + регламентное задание |
| **Требование** | LS-BR-075 — пересчёт НПСС при курсе ЦБ РФ > 5% за 7 дней (USD/EUR/CNY) |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Ввести тестовые курсы: курс USD 7 дней назад = 90, сегодня = 94.6 (+5.1%) | Регламентное задание «КонтрольАвтотриггеровНПСС» обнаруживает превышение | Журнал задания: запись «Изменение USD = 5.11% > 5%» |
| 2 | Проверить запуск пересчёта НПСС | НПСС пересчитана для позиций с USD-составляющей | Регистр «НормативнаяПлановаяСебестоимость»: ДатаФиксацииНПСС обновлена |
| 3 | Проверить уведомление финслужбе | Уведомление записано | Регистр «УведомленияПользователей»: «НПСС пересчитана, причина: курс USD вырос на 5.1%» |
| 4 | Тестовый курс: изменение = 4.9% | Триггер не срабатывает | Журнал задания: запись «Изменение USD = 4.9% < 5% — пересчёт не требуется» |

---

#### TC-035: Автотриггер НПСС при закупочной цене > 15%

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) + регламентное задание |
| **Требование** | LS-BR-075 — пересчёт НПСС при отклонении закупочной цены > 15% |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Провести поступление товара с закупочной ценой на 16% выше предыдущей | Автотриггер обнаружен | Регламентное задание «КонтрольАвтотриггеровНПСС»: запись «Закупочная цена [Номенклатура] выросла на 16%» |
| 2 | НПСС пересчитана | Дата пересчёта обновлена | Регистр «НормативнаяПлановаяСебестоимость»: новая запись для номенклатуры |
| 3 | Открытые Заказы с этой номенклатурой | Пересчёт рентабельности для открытых Заказов | Заказы «На согласовании»: реквизит «НакопленнаяПлюсЗаказ» пересчитан |
| 4 | Изменение на 14.9% | Триггер не срабатывает | Журнал: «Закупочная цена 14.9% < 15% — пересчёт не требуется» |

---

### Модуль 10: Блокировки и конкурентность

---

#### TC-036: Два пользователя редактируют одну ЛС — блокировка

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Негативный |
| **Способ** | Ручной (UI) — два сеанса одновременно |
| **Требование** | LS-BR-035 — пессимистичная блокировка через регистр БлокировкиЛС |

**Внимание:** В обычном приложении нет интерфейсной блокировки формы. Блокировка реализована через запись в регистр сведений. Тест требует двух одновременных сеансов толстого клиента.

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Менеджер-1 открывает форму Заказа, выбирает ЛС | ЛС заблокирована | Регистр «БлокировкиЛС»: запись с «ВремяИстечения» = ТекущаяДата() + 5*60 |
| 2 | Менеджер-2 пытается открыть форму Заказа с той же ЛС | Модальный диалог | «Предупреждение»: «Локальная смета редактируется: [ФИО] до [ЧЧ:ММ]» (формат Ф='ЧЧ:мм') |
| 3 | Менеджер-1 сохраняет Заказ | Блокировка снята | Регистр «БлокировкиЛС»: запись удалена |
| 4 | Менеджер-2 повторяет попытку | Создание Заказа успешно | Менеджер-2 может выбрать ЛС |

---

#### TC-037: Просмотр ЛС при наличии блокировки — не блокируется

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) — два сеанса |
| **Требование** | LS-BR-035 — просмотр ЛС и отчётов не блокируется |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Менеджер-1 редактирует Заказ (ЛС заблокирована) | Блокировка активна | Регистр «БлокировкиЛС»: запись есть |
| 2 | Менеджер-2 открывает ЛС в режиме просмотра | Просмотр доступен | Форма ЛС открылась без модального диалога о блокировке |
| 3 | Менеджер-2 открывает отчёт по ЛС | Отчёт открывается | Отчёт показывает актуальный остаток (без учёта черновика менеджера-1) |

---

### Модуль 11: Sanctions и закрытие ЛС

---

#### TC-038: Фоновое задание пересчёта санкций — retry 3x15 мин

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) + регламентное задание |
| **Требование** | п. 3.18 — санкции: 02:00 МСК, retry 3x15 мин, таймаут 2ч, алерт ФД |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Имитировать сбой при запуске фонового задания (02:00) | 1-я ошибка зафиксирована | Журнал регламентного задания: запись об ошибке |
| 2 | Первая повторная попытка через 15 мин — тоже сбой | 2-я ошибка | Журнал: 2-я запись об ошибке |
| 3 | Вторая повторная попытка (02:30) — успех | Санкции пересчитаны | Журнал: запись об успехе; регистр санкций обновлён |
| 4 | Все три попытки неуспешны | Алерт ФД | Регистр «УведомленияПользователей»: запись для ФД |

---

#### TC-039: Санкции — срок ввода блокирующего контроля

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.18 — срок ввода санкций: не позднее 1 мес. после перехода на блокирующий контроль |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Система переходит на Этап 2 | Таймер «1 мес. до ввода санкций» запущен | Регистр «КонтрольЭтапов»: запись с датой перехода |
| 2 | До истечения 1 мес. | Санкции в информационном режиме | Надпись на форме ЛС: «Санкции: информационно» |
| 3 | Истёк 1 мес. без настройки санкций | Уведомление ответственным | Регистр «УведомленияПользователей»: записи для ответственных |

---

### Модуль 12: Интеграции

---

#### TC-040: Интеграция 1С:УТ → WMS при статусе «Согласован»

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Интеграционный |
| **Способ** | Ручной (UI) + подписка на событие |
| **Требование** | LS-INT-001 — JSON, таймаут 30 сек, 3 попытки |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Заказ перешёл в статус «Согласован» | HTTP-запрос в WMS | Журнал HTTP-сервиса: исходящий запрос к WMS |
| 2 | WMS недоступна, 1-я попытка — таймаут | Повторная попытка через 30 сек | Журнал: 2-я попытка через 30 сек |
| 3 | 3-я попытка — таймаут | «Предупреждение» или запись в регистр | Регистр «УведомленияПользователей»: «WMS недоступна, ручное вмешательство» |
| 4 | WMS доступна, 1-я попытка — успех | Сообщение отправлено | Журнал: ответ WMS 200 OK; комплектация запущена |

---

#### TC-041: Интеграция WMS → 1С:УТ — расхождение факт/план

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Интеграционный |
| **Способ** | Ручной (UI) + HTTP-сервис |
| **Требование** | LS-INT-002 — при расхождении факт/план → уведомление в 1С:УТ |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | WMS завершает комплектацию: план 100 ед., факт 85 ед. | HTTP-сервис 1С:УТ получает сообщение | HTTP-сервис «ПриёмОтвётаWMS»: запрос обработан |
| 2 | Рентабельность пересчитана с 85 ед. | Менеджер уведомлён | Регистр «УведомленияПользователей»: запись о расхождении |
| 3 | Расхождение нарушает порог рентабельности | Создаётся новое согласование | Заявка: статус «На согласовании» |

---

#### TC-042: EDI-заказ — разделение по ЛС

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Интеграционный |
| **Способ** | Ручной (UI) + подписка |
| **Требование** | LS-FR-049a/b/c — EDI разделяется по ЛС |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Получить EDI-заказ с товарами из двух ЛС | Система разделяет на два под-заказа | В списке Заказов: 2 документа с ИсточникЗаказа = «EDI» по разным ЛС |
| 2 | Попытаться вручную изменить привязку позиции к другой ЛС | Операция заблокирована | «Предупреждение»: «EDI-привязка зафиксирована клиентом» |
| 3 | Одна из частей EDI нарушает рентабельность | Доступны «Одобрить»/«Отклонить» | Кнопка «КнопкаКорректировкаЦены»: Видимость = Ложь |


---

### Модуль 13: Мульти-БЮ

---

#### TC-043: Параллельное согласование мульти-БЮ — «Согласован» только при 100%

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | LS-FR-047 — параллельное согласование; «Согласован» только при согласовании всех РБЮ |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать Заказ с позициями из 3 БЮ, все с отклонением > 1 п.п. | 3 параллельные задачи в ELMA | Заявка: табличная часть «Согласующие» — 3 строки для 3 РБЮ |
| 2 | РБЮ-1 и РБЮ-2 согласовали | Статус = «Частично согласован» | Надпись «НадписьСтатус» = «Частично согласован» |
| 3 | РБЮ-3 согласовал | Статус = «Согласован» | Надпись «НадписьСтатус» = «Согласован» |

---

#### TC-044: Мульти-БЮ — один РБЮ отклонил

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Негативный |
| **Способ** | Ручной (UI) |
| **Требование** | LS-FR-048 — при отказе одного РБЮ: удалить позиции или отменить Заказ |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | РБЮ-1 согласовал, РБЮ-2 отклонил | Статус = «Частично согласован» | Надпись показывает «Частично согласован» |
| 2 | Менеджер нажимает «Удалить позиции БЮ-2» | Позиции БЮ-2 удалены | Заказ сохранён без позиций БЮ-2; кнопка «КнопкаУдалитьПозицииБЮ» привязана к процедуре модуля формы |
| 3 | Менеджер нажимает «Отменить Заказ» | Заказ в статусе «Черновик» | Надпись «НадписьСтатус» = «Черновик» |

---

### Модуль 14: Права доступа и безопасность

---

#### TC-045: RLS — менеджер видит только свои Заказы своего БЮ

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Негативный |
| **Способ** | Ручной (UI) — два пользователя |
| **Требование** | LS-SEC-001 — RLS по БЮ; менеджер не видит Заказы чужого БЮ |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Менеджер-1 (БЮ-А) открывает список Заказов | Видит только Заказы БЮ-А | Список: все документы — БЮ-А; заказы БЮ-Б отсутствуют |
| 2 | Попытаться открыть Заказ БЮ-Б напрямую по номеру | Доступ заблокирован | «Предупреждение»: «Нет доступа к данному документу» |
| 3 | РБЮ открывает список Заказов на согласовании | Видит Заказы своего БЮ | Список ограничен RLS; Директор ДРП видит все эскалированные |

---

#### TC-046: Удаление Заказа «На согласовании» — требует подтверждения РБЮ

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.11 — удаление согласованного Заказа требует подтверждения РБЮ, журналируется |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Специалист товарообмена пытается удалить Заказ «Согласован» | Запрос на подтверждение отправлен РБЮ | Регистр «УведомленияПользователей»: запись для РБЮ с запросом |
| 2 | РБЮ подтверждает удаление | Заказ удалён | Заказ помечен на удаление; транзакция завершена |
| 3 | Проверить журнал аудита | Запись о удалении | Регистр аудита: кто удалил, когда, кто подтвердил |
| 4 | Обычный менеджер пытается удалить Заказ «Согласован» | Заблокировано | «Предупреждение»: «Нет прав на удаление согласованного Заказа» |

---

### Модуль 15: Манипуляции и обходы контроля

---

#### TC-047: [MANIP] Дробление заказа на несколько мелких для обхода согласования

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Манипуляция |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.4 — контроль по накопленной рентабельности ЛС |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать Заказ-1 (20% ЛС) с отклонением 7 п.п. | Согласование требуется | Надпись «НадписьТребуемыйУровень» = «РБЮ» |
| 2 | Провести Заказ-1 через согласование | Накопленная рентабельность ухудшилась | Регистр «РентабельностьОтгруженного»: ухудшение |
| 3 | Создать Заказ-2 (ещё 20%) | Система учитывает накопленную: согласование требуется | Надпись показывает (Накопл. + Заказ) < план |
| 4 | Убедиться, что дробление не обходит контроль | Каждый Заказ проверяется с учётом уже отгруженного | Реквизит «НакопленнаяПлюсЗаказ» рассчитан правильно |

---

#### TC-048: [MANIP] Попытка изменить цену задним числом в проведённом Заказе

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Манипуляция |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.11 — точка невозврата после передачи на склад |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Заказ передан на склад («ПереданНаСклад» = Истина) | Заказ в точке невозврата | Реквизит «ПереданНаСклад» = Истина; дата передачи заполнена |
| 2 | Менеджер пытается изменить цену в Заказе | Поле цены недоступно | Колонка «Цена» в табличной части: Редактирование = Ложь (обычная форма: свойство доступности) |
| 3 | Специалист товарообмена пытается изменить цену | «Предупреждение» | «Предупреждение»: «Заказ передан на склад, редактирование невозможно» |

---

#### TC-049: [MANIP] Попытка экстренного согласования при нулевой рентабельности

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Манипуляция |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.7 — при убыточном отклонении: только стандартное согласование |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать Заказ с рентабельностью -5% | «Предупреждение»: «Рентабельность отрицательная. Требуется согласование ГД» | Модальный диалог при записи Заказа |
| 2 | Попытаться использовать экстренное согласование | Кнопка «КнопкаЭкстренноеСогласование» недоступна | Свойство Доступность = Ложь (обычная форма); при попытке нажать — «Предупреждение» |
| 3 | Попытаться обойти через EDI-заказ | Та же блокировка | Подписка на событие «ПередЗаписью» ЗаказКлиента: проверка выполняется независимо от источника |

---

#### TC-050: [MANIP] Манипуляция с НПСС — занижение для обхода контроля

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Манипуляция |
| **Способ** | Ручной (UI) — два пользователя |
| **Требование** | LS-SEC-001 — изменение НПСС требует прав финслужбы |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Менеджер пытается изменить НПСС позиции | Заблокировано | «Предупреждение»: «Нет прав на изменение НПСС» |
| 2 | Финансовый специалист изменяет НПСС | Изменение разрешено, зафиксировано в аудите | Регистр аудита: запись об изменении НПСС (кто, когда, старое/новое значение) |
| 3 | Открытые Заказы с этой номенклатурой | Пересчитываются по новой НПСС | Регламентное задание «ПересчётАктивныхЗаказов»: заказы обновлены |

---

#### TC-051: [MANIP] Повторная подача Заказа после автоотказа ГД

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Манипуляция |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.5.2 — повторная подача после автоотказа ГД |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Заказ получил автоотказ (48ч ГД) | Статус «Превышение SLA» | Надпись «НадписьСтатус» = «Отклонён» |
| 2 | Менеджер повторно подаёт Заказ без изменений | Принят к повторному рассмотрению | Реквизит «ПовторнаяПодача» = Истина; «НомерПопытки» = 2 |
| 3 | ГД снова не отвечает 48ч | Второй автоотказ; виден в отчёте ФД | Отчёт ФД: счётчик автоотказов по данному Заказу |

---

#### TC-052: [MANIP] Попытка превысить лимит итераций корректировки цены

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Манипуляция |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.5.1 — не более 5 итераций |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | 5 итераций корректировки; ни одна не приводит к норме | 5-я итерация зафиксирована | Регистр «ИтерацииКорректировкиЦены»: 5 записей |
| 2 | Согласующий пытается создать 6-ю итерацию | Заблокировано | «Предупреждение»: «Превышен лимит итераций (5). Заказ отклонён» |
| 3 | Менеджер пытается сбросить счётчик | Счётчик не сбрасывается | Подписка «ПередЗаписью» блокирует изменение реквизита «НомерИтерацииКорректировки» напрямую |

---

#### TC-053: [MANIP] Подача Заказа в нерабочее время для обхода SLA

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Манипуляция |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.6 — SLA считается в рабочих часах (09:00-18:00 МСК) |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Подать Заказ в 17:58 (за 2 мин до конца рабочего дня) | Таймер SLA = 2 мин рабочего времени сегодня | Заявка: ДатаДедлайна рассчитана через RegCalendar |
| 2 | Следующий рабочий день 09:00 | Таймер продолжает с 09:00 | ДатаДедлайна не изменилась; SLA продолжает отсчитываться |
| 3 | Убедиться, что ночное время не в SLA | SLA 4ч = 2 мин вчера + 3ч 58мин сегодня с 09:00 | Регламентное задание «ЭскалацияSLA»: учёт рабочего календаря |

---

#### TC-054: [MANIP] Снижение плана ЛС при отсутствии открытых Заказов

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Манипуляция |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.15 — изменение плана ЛС фиксируется; перекрёстный контроль для открытых Заказов |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Все текущие Заказы по ЛС — «ПереданНаСклад» | Нет открытых Заказов | Регламентное задание: нет Заказов для перекрёстного контроля |
| 2 | Руководство снижает план ЛС: 35% → 20% | Изменение зафиксировано в журнале | Регистр аудита: запись с датой, автором, старым/новым планом |
| 3 | Создать новый Заказ (откл. 14 п.п. от нового плана 20%) | Согласование уровня РБЮ (14 п.п. <= 15) | Надпись «НадписьТребуемыйУровень» = «РБЮ» (при старом плане 35% откл. было бы 21 п.п. → ДП) |
| 4 | Проверить журнал изменений плана ЛС | История изменений видна | Регистр аудита содержит все изменения плана |


---

### Модуль 16: Производительность и нагрузка

---

#### TC-055: Время обработки Заказа в пиковый период (50-70 пользователей)

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Производительность |
| **Способ** | Ручной (нагрузочное тестирование) |
| **Требование** | LS-NFR — время проведения при 50-70 одновременных пользователях |

**Примечание:** В обычном приложении 50-70 сеансов — это 50-70 соединений толстого клиента к серверу приложений 1С. Инструменты автотестирования (Vanessa, TestClient) недоступны. Нагрузочный тест выполняется вручную: открыть 70 сеансов тестовой базы на клиентских машинах.

| # | Действие | Ожидаемый результат | Как проверить |
|---|----------|---------------------|---------------|
| 1 | Открыть 50 сеансов толстого клиента, создать нагрузку 30 Заказов/мин | Система работает | Мониторинг сервера: CPU < 80%, RAM стабильна |
| 2 | Создать Заказ с автосогласованием при нагрузке | Время создания < 3 сек | Замер через ТекущаяУниверсальнаяДатаВМиллисекундах() в начале и конце процедуры |
| 3 | Создать Заказ с отправкой в ELMA при нагрузке | Время создания задачи < 5 сек | Журнал HTTP-запроса: время ответа ELMA |
| 4 | Сформировать отчёт LS-RPT-072 при нагрузке | Время формирования < 10 сек | Замер через ТекущаяУниверсальнаяДатаВМиллисекундах() |

---

#### TC-056: Расчёт рентабельности — производительность (до 500 позиций)

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Производительность |
| **Способ** | Ручной (UI) с замером |
| **Требование** | LS-NFR — расчёт рентабельности не более 2 секунд (до 500 позиций) |

| # | Действие | Ожидаемый результат | Как проверить |
|---|----------|---------------------|---------------|
| 1 | Создать ЛС с 500 позициями, создать Заказ | Расчёт запущен | — |
| 2 | Записать Заказ и дождаться пересчёта | Расчёт завершён за <= 2 сек | Замер в обработчике «ПослеЗаписи»: ТекущаяУниверсальнаяДатаВМиллисекундах() |
| 3 | Открыть форму Заказа с панелью рентабельности (500 позиций) | Открытие <= 2 сек | Замер в «ПриОткрытии» |
| 4 | Создать ЛС с 1000 позициями | Расчёт корректен | Результат верен; производительность документируется |

---

#### TC-057: Очередь согласования при 420 задачах на РБЮ

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Производительность |
| **Способ** | Ручной (UI) |
| **Требование** | п. 5 — BIZ-003: перегрузка до 420 задач/день на РБЮ в пики |

| # | Действие | Ожидаемый результат | Как проверить |
|---|----------|---------------------|---------------|
| 1 | Создать 420 задач согласования у одного РБЮ (тестовые данные) | Перелив активен (> 30), сигнал ДП (> 50) | Регистр «НагрузкаСогласующих»: ПереливАктивен = Истина; ЗадачЗаДень = 420 |
| 2 | При 31+ задачах заместители подключены | Нагрузка распределена | Заявки 31...: Согласующий = Заместитель |
| 3 | Отчёт LS-RPT-072 при 420 задачах | Формируется < 10 сек | Замер при открытии отчёта |

---

#### TC-058: Полный жизненный цикл Заказа — happy path

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | Статусная модель — 11 статусов |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать Заказ | Статус «Черновик» | Надпись «НадписьСтатус» = «Черновик» |
| 2 | Заказ без отклонений — записать | Статус «Согласован системой» | Надпись = «Согласован системой»; ELMA не задействована |
| 3 | Передать Заказ на склад | «ПереданНаСклад» = Истина | Реквизит проставлен; «ДатаПередачиНаСклад» заполнена |
| 4 | WMS сообщает о завершении комплектации | Статус «В работе» | HTTP-сервис обработал сообщение WMS; статус обновлён |
| 5 | Создать РТУ | Статус «Исполнен» | Подписка на событие РТУ: Заказ переведён в «Исполнен» |

---

#### TC-059: Невалидный переход — Заказ «Отгружен» → «Черновик»

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Негативный |
| **Способ** | Ручной (UI) |
| **Требование** | Статусная модель — невалидные переходы заблокированы |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Заказ в статусе «Исполнен» | — | Надпись «НадписьСтатус» = «Исполнен» |
| 2 | Попытка перевести в «Черновик» | Заблокировано | «Предупреждение»: «Некорректный переход статуса» |
| 3 | Попытка изменить позиции | Заблокировано | Редактирование табличной части недоступно (Доступность = Ложь) |

---

#### TC-060: Повторная проверка согласования — срок действия 5 р.д.

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Граничный |
| **Способ** | Ручной (UI) + регламентное задание |
| **Требование** | п. 3.6 — согласование действительно 5 р.д. |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Заказ получил статус «Согласован» | Таймер 5 р.д. запущен | Заявка: реквизит «СрокДействияСогласования» = ДатаСогласования + 5 р.д. |
| 2 | На 5-й рабочий день передать Заказ в работу | Успешно | Статус = «В работе» |
| 3 | Не переводить Заказ 5 р.д. | Согласование аннулировано | Регламентное задание «ПроверкаСрокаСогласования»: статус = «СоглИстекло» |
| 4 | Уведомление менеджеру | Уведомление отправлено | Регистр «УведомленияПользователей»: «Согласование аннулировано, требуется повторная подача» |

---

### Модуль 17: Проверка готовности к пилоту

---

#### TC-061: НПСС заполнена для пилотных БЮ — минимум 80%

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 5 — условие готовности к пилоту: НПСС >= 80% номенклатуры |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Открыть отчёт «ГотовностьКПилоту» | Показывает % заполненности НПСС | Отчёт содержит строки: «НПСС заполнена: X%» |
| 2 | НПСС = 75% номенклатуры | Статус: «Не готово к пилоту (75% < 80%)» | Надпись статуса или строка в отчёте |
| 3 | НПСС = 80% номенклатуры | Статус: «Готово к пилоту по НПСС» | Строка в отчёте = «Готово» |
| 4 | НПСС = 100% | Статус: «Полная готовность» | Зелёная пометка или соответствующая строка |

---

#### TC-062: Базовый замер — анализ 100+ закрытых ЛС за 6 мес.

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 5, LS-RPT-073 — базовый замер перед пилотом |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Запустить LS-RPT-073 при 120 ЛС за 6 мес. | Отчёт сформирован | Показатели: текущий уровень потерь, % ЛС ниже плана |
| 2 | Результат зафиксирован как базовый | Baseline сохранён | Запись в регистре «БазовыйЗамерKPI» с датой |

---

### Модуль 18: GAP-тесты

---

#### TC-063: Проверка числа P1-требований — 64 (закрыт HIGH-001)

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Граничный |
| **Способ** | Ручной (документарная проверка) |
| **Требование** | HIGH-001 — текст ФМ: «64 требования P1». Закрыт в v1.0.5 |

| # | Действие | Ожидаемый результат | Как проверить |
|---|----------|---------------------|---------------|
| 1 | Подсчитать все P1-требования в ФМ v1.0.5 (Confluence page 83951683) | Фактическое число = 64 | Подсчёт: LS-BR-001..LS-FR-049c, LS-INT-001..003, LS-NFR-001..004, LS-SEC-001, LS-RPT-068..074, LS-FR-070, LS-BR-075 |
| 2 | Сравнить с заявленным числом «64» в тексте ФМ v1.0.5 | Расхождение = 0 | Текст и подсчёт совпадают. DEFECT если расхождение > 0 |

---

#### TC-064: GAP-02 — Поведение при одновременном пересчёте НПСС и согласовании (закрыт)

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Граничный |
| **Способ** | Ручной (UI) — два сеанса |
| **Требование** | GAP-02 закрыт в v1.0.5: НПСС зафиксирована на момент создания Заказа; блокировка ЛС предотвращает race condition |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Согласующий просматривает Заказ (НПСС = 650) | Решение принимается по НПСС на момент создания Заказа | Заявка: реквизит «НПСС» = 650 (зафиксирована при создании) |
| 2 | В тот же момент: финслужба запускает пересчёт НПСС (новая = 700) | Пересчёт НПСС запущен | Регистр «НормативнаяПлановаяСебестоимость»: новая запись |
| 3 | Согласующий принимает решение | Решение принято по НПСС = 650 (зафиксированной) | Реквизит Заказа «НПСС» не изменился; открытые Заказы пересчитаются после завершения согласования |
| 4 | Проверить блокировку ЛС во время согласования | Новый Заказ по той же ЛС не может быть создан во время согласования (блокировка) | Регистр «БлокировкиЛС»: запись активна |

---

#### TC-065: Проверка поведения при пустой базе (нет НПСС)

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Граничный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.3 — при НПСС=NULL позиция блокируется |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать Заказ с новой номенклатурой (НПСС не заполнена) | Блокировка позиции | «Предупреждение»: «НПСС не заполнена для [Номенклатура]. Заполните НПСС и повторите» |
| 2 | Попытаться провести Заказ с заблокированными позициями | Проведение невозможно | Подписка «ПередЗаписью»: ОтменитьВыполнение = Истина; текст причины |
| 3 | Финслужба заполняет НПСС | Менеджер перезапускает Заказ | После заполнения НПСС: Заказ создаётся без блокировки |

---

#### TC-066: Срок действия согласования — ровно 5 рабочих дней

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Граничный |
| **Способ** | Ручной (UI) + регламентное задание |
| **Требование** | п. 3.6 — согласование действительно 5 р.д. |

| # | Действие | Ожидаемый результат | Как проверить |
|---|----------|---------------------|---------------|
| 1 | Заказ согласован в пятницу 17:59 | Таймер 5 р.д. запущен | Заявка: «СрокДействияСогласования» = следующий вторник |
| 2 | Следующий вторник (5-й р.д.) — перевести в работу | Согласование действительно | Статус = «В работе» |
| 3 | Следующая среда (6-й р.д.) | Согласование аннулировано | Регламентное задание: статус = «СоглИстекло» |

---

#### TC-067: Приоритизация очереди согласования (FIFO vs сумма)

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Граничный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.6 — приоритизация по сумме (убывание), при равных — FIFO |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | В очереди: Заказ-А (100 000 руб.), Заказ-Б (500 000 руб.), Заказ-В (500 000 руб.) — в порядке поступления А, Б, В | — | Заявки созданы в указанном порядке |
| 2 | Согласующий открывает очередь | Порядок: Заказ-Б или В (500 000 > 100 000) | Список задач в ELMA или форма «РабочееМестоСогласующего»: Б и В выше А |
| 3 | Заказ-Б и Заказ-В поступили в одно время | FIFO: Заказ-Б выше Заказа-В | Заявка-Б: «ДатаПостановки» < Заявки-В |

---

#### TC-068: Стратегический клиент — допустимое отклонение от стандартных порогов

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 2.1, п. 3.18 — стратегические клиенты: иные пороги рентабельности |

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Клиент включён в реестр «СтратегическиеКлиенты» | Реестр содержит допустимые отклонения | Справочник «СтратегическиеКлиенты»: запись с «ДопустимоеОтклонение» |
| 2 | Создать Заказ для стратегического клиента с нестандартным отклонением | Система применяет параметры из реестра | Расчёт уровня согласования учитывает ДопустимоеОтклонение из справочника |
| 3 | Проверить журнал | Пометка «Стратегический клиент» | Регистр аудита / Заявка: пометка о стратегическом клиенте |


---

### Модуль 19: Ручные сценарии UI (замена Gherkin v1.0.4)

> В v1.0.4 этот модуль содержал Gherkin-сценарии для Vanessa Automation (TC-063..TC-066). В v1.0.5 они заменены ручными сценариями с явным указанием элементов обычной формы.

---

#### TC-069: Ручной сценарий UI — блокировка заказа при отклонении, happy path

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) — толстый клиент |
| **Требование** | Матрица согласования: граничные значения |

**Предусловия:**
- В системе существует ЛС «ЛС-2026-001» с плановой рентабельностью 35%
- НПСС для всех позиций заполнена
- Пользователь вошёл с ролью «Менеджер по продажам»

**Сценарий 1: Заказ без отклонения — автосогласование системой**

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Меню → Продажи → Заказ клиента → Создать | Открылась форма нового Заказа | Заголовок формы: «Заказ клиента (создание)» |
| 2 | Выбрать ЛС «ЛС-2026-001», добавить позицию с ценой 1000, НПСС 650 | Рентабельность позиции = 35% | Колонка «РентабельностьПозиции» = 35,00% |
| 3 | Нажать «Записать» | Форма записана | Надпись «НадписьСтатус» = «Согласован системой» |
| 4 | Проверить: задача ELMA не создана | Нет задачи | Список задач в ELMA: нет новых задач по данному Заказу |

**Сценарий 2: Заказ с отклонением 7 п.п. → РБЮ**

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать Заказ с рентабельностью 28% (откл. 7 п.п.) по ЛС «ЛС-2026-001» | — | — |
| 2 | Нажать «Записать» | Статус «На согласовании» | Надпись «НадписьСтатус» = «На согласовании»; надпись «НадписьТребуемыйУровень» = «РБЮ» |
| 3 | Проверить ELMA | Задача создана для РБЮ | Задача содержит: номер Заказа, отклонение 7 п.п., обратный отсчёт SLA |

**Сценарий 3: Граничные значения матрицы — 7 проверок**

| Рентабельность | Отклонение | Ожидаемый уровень | Способ проверки |
|----------------|------------|-------------------|-----------------|
| 34.01% | 0.99 п.п. | Не требуется | Надпись «НадписьСтатус» = «Согласован системой» |
| 34.00% | 1.00 п.п. | РБЮ | Надпись «НадписьТребуемыйУровень» = «РБЮ» |
| 20.00% | 15.00 п.п. | РБЮ | Надпись «НадписьТребуемыйУровень» = «РБЮ» |
| 19.99% | 15.01 п.п. | ДП | Надпись «НадписьТребуемыйУровень» = «ДП» |
| 10.00% | 25.00 п.п. | ДП | Надпись «НадписьТребуемыйУровень» = «ДП» |
| 9.99% | 25.01 п.п. | ГД | Надпись «НадписьТребуемыйУровень» = «ГД» |
| -5.00% | 40.00 п.п. | ГД | Надпись «НадписьТребуемыйУровень» = «ГД»; красный цвет фона группы рентабельности |

---

#### TC-070: Ручной сценарий UI — агрегированный лимит менеджера

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) — толстый клиент |
| **Требование** | п. 3.7 — агрег. лимит менеджера 20 000 руб./день |

**Предусловия:** Менеджер «Иванов» с БЮ «Юг». Сегодня уже использовал экстренное согласование на 18 000 руб. убытка.

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать новый Заказ, нажать кнопку «КнопкаЭкстренноеСогласование» с убытком 3 000 руб. | «Предупреждение» о блокировке | «Превышен агрегированный лимит менеджера (20 000 руб./день). Текущий: 18 000 руб. Запрошено: 3 000 руб.» |
| 2 | Подтвердить «OK» в диалоге | Заказ направлен на стандартное согласование | Надпись «НадписьСтатус» = «На согласовании» (стандартное); задача ELMA создана |
| 3 | Создать Заказ с убытком 2 000 руб. (итого 20 000 = ровно лимит) | Экстренное согласование доступно | Итого = 20 000 <= 20 000: разрешено |
| 4 | Следующий рабочий день: лимит сброшен | Лимит = 0 | Регистр «ЛимитыАвтосогласования»: остаток для нового дня = 20 000 |

---

#### TC-071: Ручной сценарий UI — ELMA fallback при сбое

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.13 — резервный режим |

**Предусловия:** ELMA недоступна (имитация: изменить URL ELMA в константе на недействительный).

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Создать Заказ с отклонением 3 п.п. и нажать «Записать» | Заказ автосогласован с пометкой резервного режима | Надпись «НадписьРежимСогласования» = «Резервный режим»; статус = «Согласован» |
| 2 | Создать Заказ с отклонением 10 п.п. и нажать «Записать» | «Предупреждение»: «ELMA временно недоступна. Заказ поставлен в очередь ожидания» | Модальный диалог при записи |
| 3 | ELMA недоступна > 4 рабочих часов | IT-директор уведомлён | Регистр «УведомленияПользователей»: запись для IT-директора |

---

#### TC-072: Ручной сценарий UI — перекрёстный контроль шкал

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Негативный |
| **Способ** | Ручной (UI) |
| **Требование** | п. 3.15 — перекрёстный контроль при изменении плана ЛС |

**Предусловия:** ЛС с плановой рентабельностью 25%. Заказ-1 «На согласовании» у РБЮ (фактическая рентабельность 18%).

| # | Действие | Ожидаемый результат | Как проверить (обычная форма) |
|---|----------|---------------------|-------------------------------|
| 1 | Открыть ЛС, изменить плановую рентабельность с 25% на 45%, сохранить | Перекрёстный контроль запущен | «Вопрос»: «Изменение плана ЛС запустит перекрёстный контроль для [N] Заказов. Продолжить?» |
| 2 | Подтвердить «Да» | Система пересчитывает отклонение Заказа-1 | Отклонение = 45% - 18% = 27 п.п. → уровень ГД |
| 3 | Заказ-1 возвращён на повторное согласование к ГД | Уведомление-шаблон | Надпись на форме Заказа-1: «Заказ возвращён на согласование. Причина: изменение плана ЛС с 25% до 45%. Новый уровень: ГД. SLA: 24ч» |
| 4 | Заказ-2 в статусе «Согласован» (не передан на склад) | Также возвращён | Заказ-2: статус = «На согласовании» |

---

### Модуль 20: Риски платформы 1С:УТ 10.2 (НОВЫЕ в v1.0.5)

> Новый модуль. Проверяет стабильность расширения при специфических ограничениях и рисках платформы.

---

#### TC-073: [PLAT] Корректная работа ЭлементыФормы при открытии формы Заказа

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | Платформенное ограничение: элементы формы добавляются программно в «ПриОткрытии» |

**Контекст:** В обычных формах расширение добавляет элементы (надписи, кнопки, группы) через ЭлементыФормы.Вставить() в обработчике «ПриОткрытии». Необходимо проверить корректность добавления при различных сценариях открытия.

| # | Действие | Ожидаемый результат | Как проверить |
|---|----------|---------------------|---------------|
| 1 | Открыть форму нового Заказа клиента | Все элементы расширения присутствуют | Группа «ГруппаРентабельность» видна; надписи «НадписьРентабельность», «НадписьСтатус», «НадписьОтклонение» добавлены; кнопка «КнопкаПересчитать» активна |
| 2 | Открыть существующий Заказ (с ЛС) | Элементы заполнены значениями | Надписи показывают актуальные данные: рентабельность, статус, отклонение |
| 3 | Открыть существующий Заказ (без ЛС) | Группа рентабельности скрыта | «ГруппаРентабельность»: Видимость = Ложь |
| 4 | Открыть форму 3 раза подряд | Элементы не дублируются | Каждое открытие — ровно 1 группа, 4-5 надписей, 2-3 кнопки |
| 5 | Открыть форму при отсутствии расширения (тест отката) | Типовая форма работает штатно | Ошибок платформы нет; режим совместимости сохранён |

---

#### TC-074: [PLAT] Модальные диалоги в обычных формах — корректность блокировки формы

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | Платформенное ограничение: модальные вызовы (Предупреждение, Вопрос, ОткрытьФормуМодально) |

**Контекст:** В обычном приложении модальные вызовы блокируют форму. Важно убедиться, что в критических сценариях диалоги отображаются корректно и не приводят к потере данных.

| # | Действие | Ожидаемый результат | Как проверить |
|---|----------|---------------------|---------------|
| 1 | При записи Заказа с НПСС=0 — срабатывает «Предупреждение» | Модальный диалог открылся, форма заблокирована | Форма Заказа неактивна до закрытия диалога |
| 2 | Нажать «OK» в диалоге | Диалог закрыт, форма активна | Форма Заказа снова доступна; запись прошла |
| 3 | При попытке изменить план ЛС — «Вопрос» с кнопками Да/Нет | Диалог корректно обрабатывает оба варианта | Кнопка «Да» — запускает перекрёстный контроль; «Нет» — отменяет изменение |
| 4 | Открытие модальной формы «АктивныеБлокировкиЛС» | Форма открылась модально | Основная форма заблокирована до закрытия; данные не потеряны |

---

#### TC-075: [PLAT] Таймер ПодключитьОбработчикОжидания — обновление индикаторов нагрузки

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | Платформенное: ПодключитьОбработчикОжидания доступен в обычных формах на 8.3 |

**Контекст:** Форма рабочего места согласующего использует таймер для обновления индикаторов нагрузки (надписи «В очереди: N/30» и «За день: N/50»).

| # | Действие | Ожидаемый результат | Как проверить |
|---|----------|---------------------|---------------|
| 1 | Открыть форму «РабочееМестоСогласующего» | Таймер подключён | Надписи отображают актуальные значения |
| 2 | Дождаться 60 секунд (интервал таймера) | Надписи обновились | Значения «В очереди: N/30» и «За день: N/50» актуальны |
| 3 | При нагрузке > 30 | Надпись «В очереди» красного цвета | ЦветТекста надписи = Новый Цвет(255, 0, 0) |
| 4 | Закрыть форму | Таймер отключён | ОтключитьОбработчикОжидания() вызван в ПриЗакрытии — нет утечки памяти |

---

#### TC-076: [PLAT] Корректная работа подсветки строк через ПриВыводеСтроки

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | Платформенное: нет УсловногоОформления — подсветка через ПриВыводеСтроки и ЦветФона/ЦветТекста |

**Контекст:** В обычных формах нет объекта «УсловноеОформление». Подсветка строк в табличных частях (например, позиции с отрицательной рентабельностью) реализована через обработчик «ПриВыводеСтроки».

| # | Действие | Ожидаемый результат | Как проверить |
|---|----------|---------------------|---------------|
| 1 | Открыть Заказ с позицией, рентабельность которой < 0% | Строка в табличной части выделена красным фоном | ЦветФона строки = Новый Цвет(255, 200, 200) (светло-красный) |
| 2 | Позиция с рентабельностью 0-5% (предупреждение) | Строка желтая | ЦветФона = Новый Цвет(255, 255, 200) (светло-жёлтый) |
| 3 | Позиция с нормальной рентабельностью | Строка без подсветки (стандартный фон) | ЦветФона = стандартный |
| 4 | Прокрутить список из 1000 позиций | Подсветка сохраняется | При скролле: ПриВыводеСтроки срабатывает для каждой видимой строки |

---

#### TC-077: [PLAT] Тест после обновления платформы 8.3 — smoke-тест расширения

| Поле | Значение |
|------|----------|
| **Приоритет** | Критический |
| **Тип** | Позитивный |
| **Способ** | Ручной (UI) |
| **Требование** | Риск платформы: несовместимость при обновлении 8.3 (+40-80 ч) |

**Контекст:** При каждом обновлении 1С:Предприятие 8.3 необходимо выполнять этот smoke-тест расширения перед установкой в продуктив.

| # | Действие | Ожидаемый результат | Как проверить |
|---|----------|---------------------|---------------|
| 1 | Обновить платформу 8.3 на тестовой базе до новой версии | Конфигурация обновлена | Версия платформы в «О программе» изменилась |
| 2 | Запустить обработку «ПроверкаРасширения» (входит в поставку расширения) | Все проверки пройдены | Отчёт обработки: 0 ошибок |
| 3 | Открыть форму Заказа клиента | Элементы расширения присутствуют | Группа «ГруппаРентабельность» видна; надписи добавлены |
| 4 | Создать Заказ с отклонением 7 п.п. | Согласование запущено | Задача ELMA создана; статус = «На согласовании» |
| 5 | Проверить модальные диалоги | Диалоги работают корректно | «Предупреждение» отображается; «Вопрос» обрабатывает Да/Нет |
| 6 | Проверить таймер формы согласующего | Таймер работает | Надписи обновляются каждые 60 сек |

---

#### TC-078: [PLAT] Прекращение поддержки УТ 10.2 — ошибка в типовом коде, обход через расширение

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Негативный |
| **Способ** | Ручной (UI) |
| **Требование** | Риск платформы: отсутствие исправлений от вендора (+80-160 ч) |

**Контекст:** При обнаружении ошибки в типовом коде УТ 10.2 вендор не выпускает исправлений. Расширение должно обеспечивать обход через механизм «Вместо».

| # | Действие | Ожидаемый результат | Как проверить |
|---|----------|---------------------|---------------|
| 1 | Смоделировать ситуацию, когда типовая процедура «ПровестиДокумент» завершается с ошибкой в специфическом сценарии | Расширение перехватывает через «&Вместо» | Подписка в расширении: «&ВместоПровестиДокумент» — выполняется альтернативный код |
| 2 | Документ проведён корректно через расширение | Данные записаны | Запись в регистре выполнена; ошибка типового кода обойдена |
| 3 | Зафиксировать факт обхода в журнале | Запись в регистре «АудитОбходовОшибокПлатформы» | Регистр содержит: дата, версия платформы, описание обхода |

---

#### TC-079: [PLAT] Регрессионный тест при наличии >50 пользователей — отсутствие deadlock

| Поле | Значение |
|------|----------|
| **Приоритет** | Высокий |
| **Тип** | Производительность |
| **Способ** | Ручной (нагрузочное тестирование) |
| **Требование** | Риск платформы: 70 сеансов толстого клиента → конкуренция за серверные ресурсы |

| # | Действие | Ожидаемый результат | Как проверить |
|---|----------|---------------------|---------------|
| 1 | Открыть 70 сеансов толстого клиента (тестовая база) | Все 70 сеансов работают | Консоль сервера 1С: 70 активных соединений |
| 2 | 10 пользователей одновременно создают Заказы по разным ЛС | Нет deadlock | Технологический журнал 1С: нет записей типа DEADLOCK |
| 3 | 3 пользователя пытаются создать Заказы по одной ЛС одновременно | Первый получает блокировку; двое видят «Предупреждение» | Регистр «БлокировкиЛС»: ровно 1 активная запись |
| 4 | Мониторинг сервера в течение 4+ часов при нагрузке | Память не растёт (нет утечек) | Монитор серверных процессов: потребление RAM стабильно |

---

#### TC-080: [PLAT] Проверка корректности миграции серверной логики (тест для будущей миграции УТ 11.x)

| Поле | Значение |
|------|----------|
| **Приоритет** | Средний |
| **Тип** | Позитивный |
| **Способ** | xUnitFor1C |
| **Требование** | Риск платформы: при миграции на УТ 11.x серверная логика переносится без переработки |
| **xUnit** | МиграцияСерверняяЛогика_Тест.ПроверитьНезависимостьОтФорм() |

**Контекст:** Серверные модули расширения (КонтрольРентабельностиСервер, ЛимитыАвтосогласования, ИтерацииКорректировки и др.) не должны содержать прямых обращений к ЭлементыФормы или модальным диалогам. Это гарантирует перенос на УТ 11.x без переработки.

| # | Действие | Ожидаемый результат | Как проверить (xUnitFor1C) |
|---|----------|---------------------|--------------------------|
| 1 | Запустить xUnit-тест «ПроверитьНезависимостьОтФорм» | Все серверные модули не содержат обращений к ЭлементыФормы | Тест: анализ исходного кода серверных модулей через «СтрНайти» |
| 2 | Проверить: все формульные расчёты — в серверных модулях | Расчёты выполняются без контекста формы | Тест вызывает функцию напрямую (без открытия формы): результат корректен |
| 3 | Проверить: запись в регистры — без обращений к форме | Движения регистров выполняются в серверном контексте | xUnit: запись в регистр без открытия формы; данные корректны |

---

## Тестовые данные

| Сущность | Атрибут | Тестовые значения |
|----------|---------|-------------------|
| ЛС | Плановая рентабельность | 0%, 5%, 20%, 25%, 35%, 50%, -5% (убыточная) |
| Заказ | Сумма | 0, 99 999, 100 000, 100 001, 499 999, 500 000, 500 001 руб. |
| Заказ | Отклонение | -0.01, 0, 0.99, 1.00, 15.00, 15.01, 25.00, 25.01, 30, 50 п.п. |
| НПСС | Значение | 0, NULL, 650, 700, 1 000 руб. |
| Итерации корректировки | Счётчик | 0, 1, 4, 5, 6 |
| Нагрузка согласующего | Задач в очереди | 0, 1, 29, 30, 31, 49, 50, 51, 420 |
| Нагрузка согласующего | Задач за день | 29, 30, 31, 49, 50, 51 |
| Агрег. лимит менеджера | Убыток | 0, 15 000, 19 999, 20 000, 20 001 руб. |
| Агрег. лимит БЮ | Убыток | 0, 80 000, 99 999, 100 000, 100 001 руб. |
| Таймаут блокировки | Минуты | 3 (предупреждение), 4, 5 (снятие), 6 |
| Срок согласования | Рабочие дни | 1, 4, 5, 6 р.д. |
| Лимит экстренных | Месяц | 0, 2, 3, 4 (вне пика); 0, 9, 10, 11 (в пике) |
| НПСС авт. триггер | Курс валюты | +4.9%, +5.0%, +5.1% за 7 дней |
| НПСС авт. триггер | Закупочная цена | +14.9%, +15.0%, +15.1% |
| ELMA Fallback | Отклонение | 0, 3, 5.00, 5.01, 10 п.п. |
| Базовый замер | ЛС | 50, 99, 100, 101, 200 |
| Пилот | Предупреждения игнор. | 30%, 50%, 51%, 70% |
| Одновременные сеансы | Толстый клиент | 1, 10, 30, 50, 70 |
| Позиций в ЛС | Количество | 1, 10, 100, 499, 500, 501, 1000 |

