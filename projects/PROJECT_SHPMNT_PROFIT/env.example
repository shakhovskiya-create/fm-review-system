# ═══════════════════════════════════════════════════════════════════
# profitability-service — Environment Variables
# ═══════════════════════════════════════════════════════════════════
# Copy to .env and fill values. NEVER commit .env to git.
# Source of truth: Infisical project "profitability-service"
# ═══════════════════════════════════════════════════════════════════

# ── PostgreSQL (per-service databases) ──────────────────────────────
PROFITABILITY_DB_URL=postgres://user:pass@localhost:5432/profitability?sslmode=disable
WORKFLOW_DB_URL=postgres://user:pass@localhost:5432/workflow?sslmode=disable
ANALYTICS_DB_URL=postgres://user:pass@localhost:5432/analytics?sslmode=disable
INTEGRATION_DB_URL=postgres://user:pass@localhost:5432/integration?sslmode=disable
NOTIFICATION_DB_URL=postgres://user:pass@localhost:5432/notification?sslmode=disable

# ── Redis ───────────────────────────────────────────────────────────
REDIS_URL=redis://localhost:6379/0

# ── Kafka ───────────────────────────────────────────────────────────
KAFKA_BROKERS=localhost:9092
KAFKA_SECURITY_PROTOCOL=PLAINTEXT
# For SASL auth (staging/prod):
# KAFKA_SASL_MECHANISM=SCRAM-SHA-256
# KAFKA_SASL_USERNAME=
# KAFKA_SASL_PASSWORD=

# ── Active Directory (LDAP/Kerberos) ───────────────────────────────
AD_LDAP_URL=ldap://ad.example.com:389
AD_BIND_DN=cn=service-account,ou=services,dc=example,dc=com
AD_BIND_PASSWORD=
AD_BASE_DN=dc=example,dc=com
AD_GROUP_SEARCH_BASE=ou=groups,dc=example,dc=com

# ── JWT Authentication ──────────────────────────────────────────────
JWT_PRIVATE_KEY_PATH=/etc/profitability/jwt-rs256.key
JWT_PUBLIC_KEY_PATH=/etc/profitability/jwt-rs256.key.pub
JWT_ACCESS_TOKEN_TTL=15m
JWT_REFRESH_TOKEN_TTL=168h

# ── Claude AI (Anthropic API) ──────────────────────────────────────
ANTHROPIC_API_KEY=
AI_MODEL_ANALYST=claude-sonnet-4-6-20250514
AI_MODEL_INVESTIGATOR=claude-opus-4-6-20250514
AI_DAILY_BUDGET_USD=50
AI_SONNET_RATE_LIMIT=200
AI_OPUS_RATE_LIMIT=50

# ── ELMA BPM ───────────────────────────────────────────────────────
ELMA_API_URL=https://elma.example.com/api/v1
ELMA_API_KEY=
ELMA_TIMEOUT=10s

# ── 1С Integration ─────────────────────────────────────────────────
ODIN_C_API_URL=http://1c-server:8080/api/v1
ODIN_C_API_KEY=

# ── Notifications ──────────────────────────────────────────────────
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM=noreply@example.com

# ── ЦБ РФ ──────────────────────────────────────────────────────────
CBR_API_URL=https://www.cbr-xml-daily.ru/daily_json.js

# ── WMS ─────────────────────────────────────────────────────────────
WMS_API_URL=http://wms.example.com/api/v1
WMS_API_KEY=

# ── Observability ──────────────────────────────────────────────────
LANGFUSE_SECRET_KEY=
LANGFUSE_PUBLIC_KEY=
LANGFUSE_HOST=http://localhost:3100
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
LOG_LEVEL=info
LOG_FORMAT=json

# ── Infisical (Machine Identity for secrets rotation) ──────────────
# INFISICAL_CLIENT_ID=
# INFISICAL_CLIENT_SECRET=
# INFISICAL_PROJECT_ID=
# INFISICAL_API_URL=https://infisical.shakhoff.com/api

# ── Feature Flags ──────────────────────────────────────────────────
AUTH_MFA_ENABLED=false
INTEGRATION_MODE=mock
