#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–°–∫—Ä–∏–ø—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ 22 –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤ FM-LS-PROFIT v1.2.0
–ò—Å—Ç–æ—á–Ω–∏–∫: FM-LS-PROFIT-v1.2.0-LOGIC-FIXES.md
–ú–µ—Ç–æ–¥: –ü—Ä—è–º–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç (–ù–ï –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª)
"""

from docx import Document
from docx.shared import Pt, RGBColor
from docx.enum.text import WD_PARAGRAPH_ALIGNMENT
import re
from datetime import datetime

def find_paragraph_by_pattern(doc, pattern, start_idx=0):
    """–ù–∞–π—Ç–∏ –ø–∞—Ä–∞–≥—Ä–∞—Ñ –ø–æ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–º—É –≤—ã—Ä–∞–∂–µ–Ω–∏—é"""
    for i in range(start_idx, len(doc.paragraphs)):
        text = doc.paragraphs[i].text.strip()
        if re.search(pattern, text, re.IGNORECASE):
            return i, doc.paragraphs[i]
    return None, None

def find_paragraph_containing(doc, keyword, start_idx=0, case_sensitive=False):
    """–ù–∞–π—Ç–∏ –ø–∞—Ä–∞–≥—Ä–∞—Ñ —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ"""
    for i in range(start_idx, len(doc.paragraphs)):
        text = doc.paragraphs[i].text
        if case_sensitive:
            if keyword in text:
                return i, doc.paragraphs[i]
        else:
            if keyword.lower() in text.lower():
                return i, doc.paragraphs[i]
    return None, None

def insert_paragraph_after(doc, idx, text, style=None):
    """–í—Å—Ç–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø–∞—Ä–∞–≥—Ä–∞—Ñ –ø–æ—Å–ª–µ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞"""
    para = doc.paragraphs[idx]._element
    new_para = doc.add_paragraph(text, style=style)._element
    para.addnext(new_para)
    return new_para

def add_formatted_text(paragraph, text, bold=False, italic=False):
    """–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –≤ –ø–∞—Ä–∞–≥—Ä–∞—Ñ"""
    run = paragraph.add_run(text)
    if bold:
        run.bold = True
    if italic:
        run.italic = True
    return run

def update_version_in_header(doc, new_version):
    """–û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –≤ –∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª–µ"""
    for section in doc.sections:
        header = section.header
        for para in header.paragraphs:
            if 'v1.1.0' in para.text or 'v1.1' in para.text:
                para.text = para.text.replace('v1.1.0', new_version).replace('v1.1', new_version)
                print(f"‚úì –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è –≤ header: {new_version}")
                return True
    return False

def main():
    print("=" * 70)
    print("–ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –õ–û–ì–ò–ß–ï–°–ö–ò–• –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô v1.2.0")
    print("=" * 70)
    print()

    # –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç
    input_file = '/Users/antonsahovskii/Documents/claude-agents/fm-review-system/PROJECT_SHPMNT_PROFIT/FM_DOCUMENTS/FM-LS-PROFIT-v1.1.0-clean.docx'
    output_file = '/Users/antonsahovskii/Documents/claude-agents/fm-review-system/PROJECT_SHPMNT_PROFIT/FM_DOCUMENTS/FM-LS-PROFIT-v1.2.0.docx'

    print(f"üìñ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞: {input_file}")
    doc = Document(input_file)
    print(f"   –í—Å–µ–≥–æ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤: {len(doc.paragraphs)}")
    print()

    fixes_applied = []
    fixes_failed = []

    # =================================================================
    # CRIT-001: –ó–∞—â–∏—Ç–∞ –æ—Ç race condition (–ø. 3.5 –ê–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ)
    # =================================================================
    print("üî¥ CRIT-001: –ó–∞—â–∏—Ç–∞ –æ—Ç race condition...")
    idx, para = find_paragraph_containing(doc, "–ê–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ", 150, False)
    if idx:
        # –ò—â–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ –≥–¥–µ –≥–æ–≤–æ—Ä–∏—Ç—Å—è –ø—Ä–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –†–¢–£
        search_start = idx
        found = False
        for i in range(search_start, min(search_start + 50, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '–ø—Ä–æ–≤–µ–¥–µ–Ω' in text and '—Ä—Ç—É' in text.lower():
                # –í—Å—Ç–∞–≤–ª—è–µ–º –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                # –ü–æ–ª—É—á–∞–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π –ø–∞—Ä–∞–≥—Ä–∞—Ñ
                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç race condition: ").bold = True
                new_para_obj.add_run("–ü—Ä–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ –†–¢–£ —Å–∏—Å—Ç–µ–º–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞—Ç–æ–º–∞—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É: ")
                new_para_obj.add_run("(1)").italic = True
                new_para_obj.add_run(" –ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—É—é —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –õ–° –∏–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞; ")
                new_para_obj.add_run("(2)").italic = True
                new_para_obj.add_run(" –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –õ–° –Ω–∞ 5-10 —Å–µ–∫—É–Ω–¥; ")
                new_para_obj.add_run("(3)").italic = True
                new_para_obj.add_run(" –∞–Ω–Ω—É–ª–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –µ—Å–ª–∏ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–∏–ª–∞—Å—å; ")
                new_para_obj.add_run("(4)").italic = True
                new_para_obj.add_run(" –ø–µ—Ä–µ–¥–∞–µ—Ç –ó–∞–∫–∞–∑ –Ω–∞ —Å–∫–ª–∞–¥ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏.")

                fixes_applied.append("CRIT-001: –ó–∞—â–∏—Ç–∞ –æ—Ç race condition (–ø. 3.5)")
                found = True
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break

        if not found:
            fixes_failed.append("CRIT-001: –ù–µ –Ω–∞–π–¥–µ–Ω–æ –º–µ—Å—Ç–æ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏")
            print("   ‚úó –ù–µ –Ω–∞–π–¥–µ–Ω–æ –º–µ—Å—Ç–æ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏")
    else:
        fixes_failed.append("CRIT-001: –†–∞–∑–¥–µ–ª –ê–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # CRIT-002: –£—Ç–æ—á–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª—ã –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–æ–π —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ (–ø. 3.4)
    # =================================================================
    print("\nüî¥ CRIT-002: –£—Ç–æ—á–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª—ã —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏...")
    idx, para = find_paragraph_containing(doc, "–ö—Ä–∏—Ç–µ—Ä–∏–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è", 150, False)
    if idx:
        # –ò—â–µ–º —Ñ–æ—Ä–º—É–ª—É —Å "–Ω–∞–∫–æ–ø–ª–µ–Ω–Ω"
        for i in range(idx, min(idx + 40, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '–Ω–∞–∫–æ–ø–ª–µ–Ω–Ω' in text and ('—Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å' in text or '–º–∞—Ä–∂–∞' in text):
                # –í—Å—Ç–∞–≤–ª—è–µ–º —É—Ç–æ—á–Ω–µ–Ω–∏–µ
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –£—Ç–æ—á–Ω–µ–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–∞: ").bold = True
                new_para_obj.add_run("–í —á–∏—Å–ª–∏—Ç–µ–ª—å —Ñ–æ—Ä–º—É–ª—ã –ù–ï –≤–∫–ª—é—á–∞—é—Ç—Å—è –ó–∞–∫–∞–∑—ã –≤ —Å—Ç–∞—Ç—É—Å–µ \"–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏\" (—Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–µ –†–¢–£ + —Ç–µ–∫—É—â–∏–π –ó–∞–∫–∞–∑). –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥–≤–æ–π–Ω–æ–π —É—á–µ—Ç –º–∞—Ä–∂–∏ –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–∫–∞–∑–æ–≤ –ø–æ –æ–¥–Ω–æ–π –õ–°.")

                fixes_applied.append("CRIT-002: –£—Ç–æ—á–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª—ã (–ø. 3.4)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("CRIT-002: –†–∞–∑–¥–µ–ª –ö—Ä–∏—Ç–µ—Ä–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # CRIT-003: –§–∏–∫—Å–∞—Ü–∏—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ "–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏"
    # =================================================================
    print("\nüî¥ CRIT-003: –§–∏–∫—Å–∞—Ü–∏—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏...")
    idx, para = find_paragraph_containing(doc, "–§–∏–∫—Å–∞—Ü–∏—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏", 400, False)
    if idx:
        # –ò—â–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ –ø—Ä–æ —Ä–µ–∑–µ—Ä–≤
        for i in range(idx, min(idx + 30, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '—Ä–µ–∑–µ—Ä–≤' in text or '—Ñ–∏–∫—Å–∏—Ä' in text:
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –í–∞–∂–Ω–æ: ").bold = True
                new_para_obj.add_run("–ß–µ—Ä–Ω–æ–≤–∏–∫–∏ –ù–ï —Ñ–∏–∫—Å–∏—Ä—É—é—Ç –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å. –§–∏–∫—Å–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ó–∞–∫–∞–∑–æ–≤ –≤ —Å—Ç–∞—Ç—É—Å–∞—Ö \"–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏\" –∏–ª–∏ \"–û–∂–∏–¥–∞–µ—Ç –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è\". –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—é —á–µ—Ä–µ–∑ —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ –Ω–∞ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏.")

                fixes_applied.append("CRIT-003: –§–∏–∫—Å–∞—Ü–∏—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ (–ø. 3.16.2)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("CRIT-003: –†–∞–∑–¥–µ–ª –§–∏–∫—Å–∞—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # CRIT-004: –ü—Ä–∞–≤–∏–ª–∞ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è (–ø. 3.3)
    # =================================================================
    print("\nüî¥ CRIT-004: –ü—Ä–∞–≤–∏–ª–∞ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è...")
    idx, para = find_paragraph_containing(doc, "–£—Ä–æ–≤–Ω–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è", 150, False)
    if idx:
        # –ò—â–µ–º –≥—Ä–∞–Ω–∏—Ü—ã 15%
        for i in range(idx, min(idx + 40, len(doc.paragraphs))):
            text = doc.paragraphs[i].text
            if '15%' in text or '15 %' in text:
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –ü—Ä–∞–≤–∏–ª–∞ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è: ").bold = True
                new_para_obj.add_run("–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ–∫—Ä—É–≥–ª—è–µ—Ç—Å—è –î–û —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ (–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ 2 –∑–Ω–∞–∫–æ–≤). –ü—Ä–∏–º–µ—Ä—ã: 15.005% ‚Üí 15.01% ‚Üí –î–ü; 15.004% ‚Üí 15.00% ‚Üí –†–ë–Æ; 14.995% ‚Üí 15.00% ‚Üí –†–ë–Æ.")

                fixes_applied.append("CRIT-004: –ü—Ä–∞–≤–∏–ª–∞ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è (–ø. 3.3)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("CRIT-004: –†–∞–∑–¥–µ–ª –£—Ä–æ–≤–Ω–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # CRIT-005: –†–µ–≥–ª–∞–º–µ–Ω—Ç–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞ —Å–∞–Ω–∫—Ü–∏–π (–ø. 3.12)
    # =================================================================
    print("\nüî¥ CRIT-005: –†–µ–≥–ª–∞–º–µ–Ω—Ç–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–æ–≤...")
    idx, para = find_paragraph_containing(doc, "–í–æ–∑–≤—Ä–∞—Ç —Ç–æ–≤–∞—Ä–∞", 450, False)
    if idx:
        for i in range(idx, min(idx + 40, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '—Å–∞–Ω–∫—Ü' in text or '–ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∫—É–ø–∞' in text or '80%' in text:
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –ü–µ—Ä–µ—Å—á–µ—Ç —Å–∞–Ω–∫—Ü–∏–π: ").bold = True
                new_para_obj.add_run("–†–µ–≥–ª–∞–º–µ–Ω—Ç–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ, –Ω–æ—á—å—é) –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–∞–Ω–∫—Ü–∏–∏ –¥–ª—è –∑–∞–∫—Ä—ã—Ç—ã—Ö –õ–° –ø—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ —Ç–æ–≤–∞—Ä–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 60 –¥–Ω–µ–π –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è. –ï—Å–ª–∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∫—É–ø–∞ —Å–Ω–∏–∂–∞–µ—Ç—Å—è –Ω–∏–∂–µ 80%, –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å–∞–Ω–∫—Ü–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ –ø. 3.16.8.")

                fixes_applied.append("CRIT-005: –†–µ–≥–ª–∞–º–µ–Ω—Ç–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ (–ø. 3.12)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("CRIT-005: –†–∞–∑–¥–µ–ª –í–æ–∑–≤—Ä–∞—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # CRIT-006: –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ 1 —Ä–∞–∑ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ø–æ–∑–∏—Ü–∏—é (–ø. 3.16.5)
    # =================================================================
    print("\nüî¥ CRIT-006: –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ –õ–°...")
    idx, para = find_paragraph_containing(doc, "–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–Ω–∏", 400, False)
    if not idx:
        idx, para = find_paragraph_containing(doc, "–∞–≤—Ç–æ–ø—Ä–æ–¥–ª", 400, False)
    if idx:
        for i in range(idx, min(idx + 30, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '–∞–≤—Ç–æ–ø—Ä–æ–¥–ª' in text or '–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫' in text and '–ø—Ä–æ–¥–ª' in text:
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –£—Ç–æ—á–Ω–µ–Ω–∏–µ: ").bold = True
                new_para_obj.add_run("–ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è 1 —Ä–∞–∑ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã (–Ω–µ –Ω–∞ –≤—Å—é –õ–°). –°—á–µ—Ç—á–∏–∫ –∞–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ —Å–≤–µ–¥–µ–Ω–∏–π \"–ò—Å—Ç–æ—Ä–∏—è –∞–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–π –õ–°\" (–õ–° + –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞ + –î–∞—Ç–∞).")

                fixes_applied.append("CRIT-006: –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ (–ø. 3.16.5)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("CRIT-006: –†–∞–∑–¥–µ–ª –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # CRIT-007: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –ø—Ä–∏ —á–∞—Å—Ç–∏—á–Ω–æ–º –Ω–∞–ª–∏—á–∏–∏ (–ø. 3.16.8)
    # =================================================================
    print("\nüî¥ CRIT-007: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ–∏–∫—Å–∞—Ü–∏–∏...")
    idx, para = find_paragraph_containing(doc, "–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–π –¥–µ—Ñ–∏—Ü–∏—Ç", 500, False)
    if not idx:
        idx, para = find_paragraph_containing(doc, "–¥–µ—Ñ–∏—Ü–∏—Ç", 500, False)
    if idx:
        for i in range(idx, min(idx + 40, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '–¥–µ—Ñ–∏—Ü–∏—Ç' in text and ('–ø–æ–¥—Ç–≤–µ—Ä–∂–¥' in text or '—Ñ–∏–∫—Å–∞—Ü' in text):
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ–µ –Ω–∞–ª–∏—á–∏–µ: ").bold = True
                new_para_obj.add_run("–ü—Ä–∏ —á–∞—Å—Ç–∏—á–Ω–æ–º –Ω–∞–ª–∏—á–∏–∏ —Ç–æ–≤–∞—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –õ–° 100 –µ–¥., –≤ –Ω–∞–ª–∏—á–∏–∏ 30, –¥–µ—Ñ–∏—Ü–∏—Ç 70) –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ: (1) —á–∞—Å—Ç—å \"–≤ –Ω–∞–ª–∏—á–∏–∏\" (30) –ø—Ä–æ—Ö–æ–¥–∏—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏; (2) —á–∞—Å—Ç—å \"–≤ –¥–µ—Ñ–∏—Ü–∏—Ç–µ\" (70) —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–π –¥–µ—Ñ–∏—Ü–∏—Ç ‚Üí —Å–∞–Ω–∫—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∏ –Ω–µ–≤—ã–∫—É–ø–µ —ç—Ç–æ–π —á–∞—Å—Ç–∏.")

                fixes_applied.append("CRIT-007: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ–∏–∫—Å–∞—Ü–∏–∏ (–ø. 3.16.8)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("CRIT-007: –†–∞–∑–¥–µ–ª –î–µ—Ñ–∏—Ü–∏—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # HIGH-001: –ê–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–ª–∞–Ω–∞ –õ–° (–ø. 3.5, 3.13)
    # =================================================================
    print("\nüü† HIGH-001: –ê–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –õ–°...")
    idx, para = find_paragraph_containing(doc, "–ò–∑–º–µ–Ω–µ–Ω–∏–µ –õ–°", 500, False)
    if not idx:
        idx, para = find_paragraph_containing(doc, "–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –õ–°", 500, False)
    if idx:
        for i in range(idx, min(idx + 40, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '–∏–∑–º–µ–Ω–µ–Ω' in text or '–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä' in text:
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –ê–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏: ").bold = True
                new_para_obj.add_run("–ü—Ä–∏ –õ–Æ–ë–û–ú –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–ª–∞–Ω–∞ –õ–° (–ø–æ–≤—ã—à–µ–Ω–∏–µ –∏–ª–∏ –ø–æ–Ω–∏–∂–µ–Ω–∏–µ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏) –ó–∞–∫–∞–∑—ã –≤ —Å—Ç–∞—Ç—É—Å–µ \"–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏\" –∞–Ω–Ω—É–ª–∏—Ä—É—é—Ç—Å—è –ï–°–õ–ò –º–µ–Ω—è–µ—Ç—Å—è —Ç—Ä–µ–±—É–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è. –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ –∑–∞–∫–∞–∑ —Å–æ–≥–ª–∞—Å–æ–≤—ã–≤–∞–ª –†–ë–Æ –ø—Ä–∏ –ø–ª–∞–Ω–µ 20%, –∞ –ø–æ—Å–ª–µ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø–ª–∞–Ω–∞ –¥–æ 30% —ç—Ç–æ–≥–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.")

                fixes_applied.append("HIGH-001: –ê–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –õ–° (–ø. 3.13)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("HIGH-001: –†–∞–∑–¥–µ–ª –ò–∑–º–µ–Ω–µ–Ω–∏–µ –õ–° –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # HIGH-002: –ê—Ç–æ–º–∞—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ó–∞–∫–∞–∑–∞ (–ø. 3.14.1)
    # =================================================================
    print("\nüü† HIGH-002: –ê—Ç–æ–º–∞—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏...")
    idx, para = find_paragraph_containing(doc, "–ó–∞—â–∏—Ç–∞ –æ—Ç –≥–æ–Ω–∫–∏", 500, False)
    if idx:
        for i in range(idx, min(idx + 40, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '–±–ª–æ–∫–∏—Ä–æ–≤' in text or '–∑–∞—â–∏—Ç' in text:
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –ø–µ—Ä–µ—Å—á–µ—Ç: ").bold = True
                new_para_obj.add_run("–ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ó–∞–∫–∞–∑–∞ —Å–∏—Å—Ç–µ–º–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –ø–µ—Ä–µ—Å—á–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–æ–π —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ (–ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞). –≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –†–¢–£ –∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ó–∞–∫–∞–∑–∞.")

                fixes_applied.append("HIGH-002: –ê—Ç–æ–º–∞—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–ø. 3.14.1)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("HIGH-002: –†–∞–∑–¥–µ–ª –ó–∞—â–∏—Ç–∞ –æ—Ç –≥–æ–Ω–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # HIGH-003: Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–º —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏ (–ø. 3.6)
    # =================================================================
    print("\nüü† HIGH-003: Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ...")
    idx, para = find_paragraph_containing(doc, "–≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ", 200, False)
    if idx:
        for i in range(idx, min(idx + 40, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '—É—Å—Ç–Ω–æ–µ' in text or '—ç–∫—Å—Ç—Ä–µ–Ω–Ω' in text:
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç —Ñ–∞–ª—å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: ").bold = True
                new_para_obj.add_run("–ü—Ä–∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–º —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏ —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å—É—é—â–µ–º—É: \"–í–∞–º –ø—Ä–∏–ø–∏—Å–∞–Ω–æ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –ó–∞–∫–∞–∑–∞ ‚ÑñXXX (–ö–ª–∏–µ–Ω—Ç, –°—É–º–º–∞, –ú–µ–Ω–µ–¥–∂–µ—Ä). –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω–∏—Ç–µ –≤ —Ç–µ—á–µ–Ω–∏–µ 2 —á–∞—Å–æ–≤.\" –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è = –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞–∑.")

                fixes_applied.append("HIGH-003: Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–ø. 3.6)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("HIGH-003: –†–∞–∑–¥–µ–ª –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # HIGH-004: –†–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏—è —Å–∞–Ω–∫—Ü–∏–π —á–µ—Ä–µ–∑ 3 –º–µ—Å—è—Ü–∞ (–ø. 3.16.8)
    # =================================================================
    print("\nüü† HIGH-004: –†–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏—è —Å–∞–Ω–∫—Ü–∏–π...")
    idx, para = find_paragraph_containing(doc, "—Å–∞–Ω–∫—Ü", 600, False)
    if idx:
        for i in range(idx, min(idx + 50, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '—Å–∞–Ω–∫—Ü' in text and ('—Å–Ω—è—Ç' in text or '—Ä–µ–∞–±–∏–ª–∏—Ç' in text or '–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª' in text):
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –°—Ä–æ–∫ —Ä–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏–∏: ").bold = True
                new_para_obj.add_run("–ü–æ–ª–Ω–æ–µ —Å–Ω—è—Ç–∏–µ —Å–∞–Ω–∫—Ü–∏–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ 3 –º–µ—Å—è—Ü–∞ (–∫–≤–∞—Ä—Ç–∞–ª) –±–µ–∑ –Ω–æ–≤—ã—Ö –Ω–∞—Ä—É—à–µ–Ω–∏–π. –°—á–µ—Ç—á–∏–∫ –æ–±–Ω—É–ª—è–µ—Ç—Å—è –¥–æ 0. –ü—Ä–∏ —á–∞—Å—Ç–∏—á–Ω–æ–º —Å–Ω—è—Ç–∏–∏ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∞–Ω–∫—Ü–∏–π —Å—Ä–æ–∫ –æ—Ç—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –Ω–∞—Ä—É—à–µ–Ω–∏—è.")

                fixes_applied.append("HIGH-004: –†–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏—è 3 –º–µ—Å—è—Ü–∞ (–ø. 3.16.8)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("HIGH-004: –†–∞–∑–¥–µ–ª –°–∞–Ω–∫—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # HIGH-005: –≠—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–∏ —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏–∏ –ù–ü–°–° (–ø. 3.14.2)
    # =================================================================
    print("\nüü† HIGH-005: –≠—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–∏ —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏–∏ –ù–ü–°–°...")
    idx, para = find_paragraph_containing(doc, "–∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –ù–ü–°–°", 550, False)
    if not idx:
        idx, para = find_paragraph_containing(doc, "—É—Å—Ç–∞—Ä–µ–≤—à", 550, False)
    if idx:
        for i in range(idx, min(idx + 40, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '–Ω–ø—Å—Å' in text or '—Å–º–µ—Ç' in text:
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –≠—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–∏ >80 –¥–Ω–µ–π: ").bold = True
                new_para_obj.add_run("–ï—Å–ª–∏ –≤–æ–∑—Ä–∞—Å—Ç –ù–ü–°–° –ø—Ä–µ–≤—ã—à–∞–µ—Ç 80 –¥–Ω–µ–π (–¥–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ 90 –¥–Ω–µ–π), –î–ü –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–¥–∞–∂. –ü—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ –í–°–ï –∑–∞–∫–∞–∑—ã (–ª—é–±–∞—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å) —Ç—Ä–µ–±—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –†–ë–Æ –¥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ù–ü–°–°.")

                fixes_applied.append("HIGH-005: –≠—Å–∫–∞–ª–∞—Ü–∏—è –ù–ü–°–° (–ø. 3.14.2)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("HIGH-005: –†–∞–∑–¥–µ–ª –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –ù–ü–°–° –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # HIGH-006: –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏–∑ —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ –†–¢–£ (–ø. 3.12)
    # =================================================================
    print("\nüü† HIGH-006: –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –≤–æ–∑–≤—Ä–∞—Ç–∞...")
    idx, para = find_paragraph_containing(doc, "–í–æ–∑–≤—Ä–∞—Ç —Ç–æ–≤–∞—Ä–∞", 450, False)
    if idx:
        # –ò—â–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ –ø—Ä–æ —Å–≤—è–∑—å —Å –†–¢–£ –∏–ª–∏ —Ä–∞—Å—á–µ—Ç —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
        for i in range(idx, min(idx + 50, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '—Ä—Ç—É' in text and ('–≤–æ–∑–≤—Ä–∞—Ç' in text or '—Å–≤—è–∑' in text or '–æ—Å–Ω–æ–≤–∞–Ω' in text):
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –§–∏–∫—Å–∞—Ü–∏—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏: ").bold = True
                new_para_obj.add_run("–†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –≤–æ–∑–≤—Ä–∞—Ç–∞ –±–µ—Ä–µ—Ç—Å—è –∏–∑ —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ –†–¢–£ (–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –º–æ–º–µ–Ω—Ç –æ—Ç–≥—Ä—É–∑–∫–∏), –ù–ï –∏–∑ —Ç–µ–∫—É—â–µ–π –ù–ü–°–°. –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–µ—Ä–µ—Å—á–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–æ–π —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–µ–Ω –≤ –ù–ü–°–° –ø–æ—Å–ª–µ –æ—Ç–≥—Ä—É–∑–∫–∏.")

                fixes_applied.append("HIGH-006: –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –≤–æ–∑–≤—Ä–∞—Ç–∞ (–ø. 3.12)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("HIGH-006: –†–∞–∑–¥–µ–ª –í–æ–∑–≤—Ä–∞—Ç —Ç–æ–≤–∞—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # HIGH-007: –ú—É–ª—å—Ç–∏-–ë–Æ –∑–∞–∫–∞–∑ (–ø. 3.7)
    # =================================================================
    print("\nüü† HIGH-007: –ú—É–ª—å—Ç–∏-–ë–Æ –∑–∞–∫–∞–∑...")
    idx, para = find_paragraph_containing(doc, "–±–∏–∑–Ω–µ—Å-—é–Ω–∏—Ç", 300, False)
    if not idx:
        idx, para = find_paragraph_containing(doc, "–Ω–µ—Å–∫–æ–ª—å", 300, False)
    if idx:
        for i in range(idx, min(idx + 50, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '–±—é' in text or '–±–∏–∑–Ω–µ—Å' in text or '–Ω–µ—Å–∫–æ–ª—å' in text:
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –û—Ç–º–µ–Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è: ").bold = True
                new_para_obj.add_run("–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–∑–∏—Ü–∏–π –∏–∑ –º—É–ª—å—Ç–∏-–ë–Æ –∑–∞–∫–∞–∑–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –ù–ï —Ç—Ä–µ–±—É–µ—Ç—Å—è, –µ—Å–ª–∏ –∏—Ç–æ–≥–æ–≤–∞—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å >= –ø–ª–∞–Ω - 1 –ø.–ø. –≠—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—Ä–∏ —É–ª—É—á—à–µ–Ω–∏–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.")

                fixes_applied.append("HIGH-007: –ú—É–ª—å—Ç–∏-–ë–Æ (–ø. 3.7)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("HIGH-007: –†–∞–∑–¥–µ–ª –ú—É–ª—å—Ç–∏-–ë–Æ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # HIGH-008: –õ–∏–º–∏—Ç —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–π –ø–æ –∫–ª–∏–µ–Ω—Ç—É (–ø. 3.6)
    # =================================================================
    print("\nüü† HIGH-008: –õ–∏–º–∏—Ç –ø–æ –∫–ª–∏–µ–Ω—Ç—É...")
    idx, para = find_paragraph_containing(doc, "–≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ", 200, False)
    if idx:
        for i in range(idx, min(idx + 50, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '–ª–∏–º–∏—Ç' in text or '–∫–æ–ª–∏—á–µ—Å—Ç–≤' in text or '3' in text:
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –î–≤–æ–π–Ω–æ–π –ª–∏–º–∏—Ç: ").bold = True
                new_para_obj.add_run("–≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ: (1) –Ω–µ –±–æ–ª–µ–µ 3 –Ω–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –≤ –º–µ—Å—è—Ü; (2) –Ω–µ –±–æ–ª–µ–µ 5 –Ω–∞ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ –≤ –º–µ—Å—è—Ü (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞). –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ–±—Ö–æ–¥ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤.")

                fixes_applied.append("HIGH-008: –õ–∏–º–∏—Ç –ø–æ –∫–ª–∏–µ–Ω—Ç—É (–ø. 3.6)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("HIGH-008: –†–∞–∑–¥–µ–ª –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # HIGH-009: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–∞ (–ø. 3.16.2)
    # =================================================================
    print("\nüü† HIGH-009: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–æ–≤...")
    idx, para = find_paragraph_containing(doc, "–§–∏–∫—Å–∞—Ü–∏—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏", 400, False)
    if idx:
        for i in range(idx, min(idx + 40, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '—Ä–µ–∑–µ—Ä–≤' in text or '—Ñ–∏–∫—Å–∞—Ü' in text or '–±–ª–æ–∫–∏—Ä–æ–≤' in text:
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –¢–∏–ø—ã —Ä–µ–∑–µ—Ä–≤–æ–≤: ").bold = True
                new_para_obj.add_run("–°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–¥–µ–ª—è–µ—Ç: (1) –õ–æ–≥–∏—á–µ—Å–∫–∏–π —Ä–µ–∑–µ—Ä–≤ –õ–° - –Ω–∞ –ø–µ—Ä–∏–æ–¥ –¥–µ—Ñ–∏—Ü–∏—Ç–∞, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥—Ä—É–≥–∏–µ –∑–∞–∫–∞–∑—ã; (2) –§–∏–∑–∏—á–µ—Å–∫–∏–π —Ä–µ–∑–µ—Ä–≤ —Ç–æ–≤–∞—Ä–∞ - –ø–æ—Å–ª–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 48 —á–∞—Å–æ–≤ —Å –º–æ–º–µ–Ω—Ç–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞. –ü–æ—Å–ª–µ 48—á —Ç–æ–≤–∞—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –≤—Å–µ–º.")

                fixes_applied.append("HIGH-009: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–æ–≤ (–ø. 3.16.2)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("HIGH-009: –†–∞–∑–¥–µ–ª –§–∏–∫—Å–∞—Ü–∏—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # MED-001: –ê–≤—Ç–æ—Å–Ω—è—Ç–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —á–µ—Ä–Ω–æ–≤–∏–∫–∞ (–ø. 3.10)
    # =================================================================
    print("\nüü° MED-001: –ê–≤—Ç–æ—Å–Ω—è—Ç–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏...")
    idx, para = find_paragraph_containing(doc, "–ß–µ—Ä–Ω–æ–≤–∏–∫", 350, False)
    if idx:
        for i in range(idx, min(idx + 40, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '—á–µ—Ä–Ω–æ–≤–∏–∫' in text and ('—É–¥–∞–ª' in text or '–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫' in text or '7' in text):
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –°–Ω—è—Ç–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏: ").bold = True
                new_para_obj.add_run("–ü—Ä–∏ –∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–∏ —á–µ—Ä–Ω–æ–≤–∏–∫–∞ >7 –¥–Ω–µ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –õ–° —Å–Ω–∏–º–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –†–µ–≥–ª–∞–º–µ–Ω—Ç–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –õ–° –µ–∂–µ–¥–Ω–µ–≤–Ω–æ.")

                fixes_applied.append("MED-001: –ê–≤—Ç–æ—Å–Ω—è—Ç–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (–ø. 3.10)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("MED-001: –†–∞–∑–¥–µ–ª –ß–µ—Ä–Ω–æ–≤–∏–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # MED-003: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ –ø–æ —Å—Ç–æ—Ä–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –†–¢–£ (–ø. 3.12)
    # =================================================================
    print("\nüü° MED-003: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–æ—Ä–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –†–¢–£...")
    idx, para = find_paragraph_containing(doc, "–í–æ–∑–≤—Ä–∞—Ç —Ç–æ–≤–∞—Ä–∞", 450, False)
    if idx:
        # –£–∂–µ –¥–æ–±–∞–≤–ª—è–ª–∏ –∫ —ç—Ç–æ–º—É —Ä–∞–∑–¥–µ–ª—É, –¥–æ–±–∞–≤–∏–º –µ—â–µ –æ–¥–∏–Ω –ø–∞—Ä–∞–≥—Ä–∞—Ñ
        for i in range(idx, min(idx + 60, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '–≤–æ–∑–≤—Ä–∞—Ç' in text and ('60' in text or '—Å—Ç–æ—Ä–Ω–∏—Ä' in text or '–∏—Å–∫–ª—é—á' in text):
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –°—Ç–æ—Ä–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –†–¢–£: ").bold = True
                new_para_obj.add_run("–í–æ–∑–≤—Ä–∞—Ç—ã –ø–æ —Å—Ç–æ—Ä–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –†–¢–£ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è –∏–∑ —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –≤—ã–∫—É–ø–∞. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –†–¢–£-–æ—Å–Ω–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Å–∞–Ω–∫—Ü–∏–π.")

                fixes_applied.append("MED-003: –°—Ç–æ—Ä–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –†–¢–£ (–ø. 3.12)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("MED-003: –†–∞–∑–¥–µ–ª –í–æ–∑–≤—Ä–∞—Ç —Ç–æ–≤–∞—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # MED-004: –ö–æ–Ω—Ç—Ä–æ–ª—å —É–±—ã—Ç–∫–∞ - –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (–ø. 3.4)
    # =================================================================
    print("\nüü° MED-004: –ü—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —É–±—ã—Ç–∫–∞...")
    idx, para = find_paragraph_containing(doc, "–ö—Ä–∏—Ç–µ—Ä–∏–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è", 150, False)
    if idx:
        for i in range(idx, min(idx + 50, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '—É–±—ã—Ç' in text or '–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω' in text or '–º–∏–Ω—É—Å' in text:
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –ü–æ—Ä–æ–≥ —É–±—ã—Ç–∫–∞: ").bold = True
                new_para_obj.add_run("–ê–≤—Ç–æ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –ø—Ä–∏ —É–±—ã—Ç–∫–µ –¥–æ -0.1% –æ—Ç —Å—É–º–º—ã –ó–∞–∫–∞–∑–∞. –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ - –∂–µ—Å—Ç–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å—É–º–º–∞—Ä–Ω—ã–π —É–±—ã—Ç–æ–∫ –ø–æ –õ–° –∑–∞ –¥–µ–Ω—å (–∑–∞—â–∏—Ç–∞ –æ—Ç –¥—Ä–æ–±–ª–µ–Ω–∏—è —É–±—ã—Ç–æ—á–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤).")

                fixes_applied.append("MED-004: –ü—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–π —É–±—ã—Ç–æ–∫ (–ø. 3.4)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("MED-004: –†–∞–∑–¥–µ–ª –ö—Ä–∏—Ç–µ—Ä–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # MED-005: –†–¢–£ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è (–ø. 3.11)
    # =================================================================
    print("\nüü° MED-005: –†–¢–£ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è...")
    idx, para = find_paragraph_containing(doc, "–†–¢–£", 400, False)
    if not idx:
        idx, para = find_paragraph_containing(doc, "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ", 400, False)
    if idx:
        for i in range(idx, min(idx + 40, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '—Ä—Ç—É' in text and ('—Å–æ–∑–¥–∞–Ω' in text or '–∞–≤—Ç–æ–º–∞—Ç–∏—á' in text):
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –ë–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è: ").bold = True
                new_para_obj.add_run("–†–¢–£, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–≥–æ –ó–∞–∫–∞–∑–∞, –ù–ï –ø—Ä–æ—Ö–æ–¥—è—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ (—Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏). –≠—Ç–æ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ –∏ —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É.")

                fixes_applied.append("MED-005: –†–¢–£ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–∞ (–ø. 3.11)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("MED-005: –†–∞–∑–¥–µ–ª –†–¢–£ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # LOW-001: –£—Ç–æ—á–Ω–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü KPI (–ø. 3.16.9)
    # =================================================================
    print("\nüü¢ LOW-001: –£—Ç–æ—á–Ω–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü KPI...")
    idx, para = find_paragraph_containing(doc, "KPI", 700, False)
    if not idx:
        idx, para = find_paragraph_containing(doc, "–ö–∞—á–µ—Å—Ç–≤–æ –õ–°", 700, False)
    if idx:
        for i in range(idx, min(idx + 50, len(doc.paragraphs))):
            text = doc.paragraphs[i].text
            if '95%' in text or 'KPI' in text:
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –ì—Ä–∞–Ω–∏—Ü—ã —à–∫–∞–ª—ã: ").bold = True
                new_para_obj.add_run("–£—Ç–æ—á–Ω–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞ KPI \"–ö–∞—á–µ—Å—Ç–≤–æ –õ–°\": 95%+ = 120%; 90-94.99% = 100%; 85-89.99% = 90%; 80-84.99% = 80%; 70-79.99% = 60%; <70% = 0%. –≠—Ç–æ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤.")

                fixes_applied.append("LOW-001: –ì—Ä–∞–Ω–∏—Ü—ã KPI (–ø. 3.16.9)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("LOW-001: –†–∞–∑–¥–µ–ª KPI –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # LOW-002: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è –≤ FAQ (FAQ + –ø. 3.8)
    # =================================================================
    print("\nüü¢ LOW-002: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ FAQ...")
    idx, para = find_paragraph_containing(doc, "FAQ", 800, False)
    if idx:
        for i in range(idx, min(idx + 50, len(doc.paragraphs))):
            text = doc.paragraphs[i].text.lower()
            if '–ø—Ä–æ–¥–ª' in text or '–∏–∑–º–µ–Ω–µ–Ω' in text or '2 —Ä–∞–∑' in text:
                new_para = doc.paragraphs[i]._element
                added = doc.add_paragraph()._element
                new_para.addnext(added)

                new_para_obj = doc.paragraphs[i+1]
                new_para_obj.add_run("‚ö†Ô∏è –£—Ç–æ—á–Ω–µ–Ω–∏–µ –ø—Ä–æ –∞–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ: ").bold = True
                new_para_obj.add_run("–õ–∏–º–∏—Ç \"–Ω–µ –±–æ–ª–µ–µ 2 —Ä–∞–∑\" –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ —Ä—É—á–Ω—ã–º –ø—Ä–æ–¥–ª–µ–Ω–∏—è–º. –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ (–ø. 3.16.5) –ù–ï —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ —ç—Ç–æ–º –ª–∏–º–∏—Ç–µ.")

                fixes_applied.append("LOW-002: FAQ –∞–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ (FAQ)")
                print(f"   ‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ {i}")
                break
    else:
        fixes_failed.append("LOW-002: –†–∞–∑–¥–µ–ª FAQ –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚úó –†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")

    # =================================================================
    # –û–ë–ù–û–í–õ–ï–ù–ò–ï –í–ï–†–°–ò–ò
    # =================================================================
    print("\n" + "=" * 70)
    print("–û–ë–ù–û–í–õ–ï–ù–ò–ï –ú–ï–¢–ê–î–ê–ù–ù–´–•")
    print("=" * 70)

    # –û–±–Ω–æ–≤–ª—è–µ–º –≤–µ—Ä—Å–∏—é –≤ header
    updated_header = update_version_in_header(doc, 'v1.2.0')
    if not updated_header:
        print("‚ö†Ô∏è  –í–µ—Ä—Å–∏—è –≤ header –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ (–≤–æ–∑–º–æ–∂–Ω–æ, header –ø—É—Å—Ç–æ–π)")

    # –ò—â–µ–º –≤–µ—Ä—Å–∏—é –≤ —Ç–µ–ª–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º
    print("\n–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –≤ —Ç–µ–ª–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞...")
    version_found = False
    for i, para in enumerate(doc.paragraphs[:50]):
        if 'v1.1.0' in para.text or '–í–µ—Ä—Å–∏—è 1.1.0' in para.text:
            para.text = para.text.replace('v1.1.0', 'v1.2.0').replace('–í–µ—Ä—Å–∏—è 1.1.0', '–í–µ—Ä—Å–∏—è 1.2.0')
            print(f"‚úì –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è –≤ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–µ {i}")
            version_found = True

    if not version_found:
        print("‚ö†Ô∏è  –í–µ—Ä—Å–∏—è –≤ —Ç–µ–ª–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")

    # –î–æ–±–∞–≤–ª—è–µ–º –¥–∞—Ç—É –∏–∑–º–µ–Ω–µ–Ω–∏—è
    print("\n–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞—Ç—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è...")
    today = datetime.now().strftime("%d.%m.%Y")
    for i, para in enumerate(doc.paragraphs[:50]):
        if '–î–∞—Ç–∞' in para.text or '–¥–∞—Ç–∞' in para.text:
            if '–∏–∑–º–µ–Ω–µ–Ω–∏—è' in para.text.lower() or '–≤–µ—Ä—Å–∏–∏' in para.text.lower():
                para.text = f"–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è: {today}"
                print(f"‚úì –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–∞—Ç–∞ –≤ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–µ {i}")
                break

    # =================================================================
    # –°–û–•–†–ê–ù–ï–ù–ò–ï –î–û–ö–£–ú–ï–ù–¢–ê
    # =================================================================
    print("\n" + "=" * 70)
    print("–°–û–•–†–ê–ù–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–ê")
    print("=" * 70)
    print(f"\nüìù –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞: {output_file}")
    doc.save(output_file)
    print("‚úì –î–æ–∫—É–º–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω")

    # =================================================================
    # –ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢
    # =================================================================
    print("\n" + "=" * 70)
    print("–ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢")
    print("=" * 70)

    print(f"\n‚úÖ –£—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ: {len(fixes_applied)} –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π")
    for fix in fixes_applied:
        print(f"   ‚úì {fix}")

    if fixes_failed:
        print(f"\n‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–∏–º–µ–Ω–∏—Ç—å: {len(fixes_failed)} –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π")
        for fix in fixes_failed:
            print(f"   ‚úó {fix}")

    print(f"\nüìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
    print(f"   - –í—Å–µ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π: 22")
    print(f"   - –ü—Ä–∏–º–µ–Ω–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ: {len(fixes_applied)}")
    print(f"   - –ù–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ: {len(fixes_failed)}")
    print(f"   - –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: {len(fixes_applied)/22*100:.1f}%")

    print("\n‚úÖ –î–æ–∫—É–º–µ–Ω—Ç FM-LS-PROFIT v1.2.0 –≥–æ—Ç–æ–≤!")
    print("=" * 70)

if __name__ == "__main__":
    main()
