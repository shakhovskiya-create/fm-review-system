# DOCX Editing Skill

## –¢—Ä–∏–≥–≥–µ—Ä

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å, –∏–∑–º–µ–Ω–∏—Ç—å, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å —Ä–µ–≤—å—é .docx —Ñ–∞–π–ª–∞ ‚Äî –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò —Å–ª–µ–¥—É–π —ç—Ç–æ–º—É workflow –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤.

## –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤

**–î–ª—è –ø—Ä–æ–µ–∫—Ç–∞ FM-LS-PROFIT:**
```
PROJECT_SHPMNT_PROFIT/tools/
‚îú‚îÄ‚îÄ unpack.py         # –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ + merge runs
‚îú‚îÄ‚îÄ pack.py           # –£–ø–∞–∫–æ–≤–∫–∞ + –≤–∞–ª–∏–¥–∞—Ü–∏—è
‚îú‚îÄ‚îÄ batch_replace.py  # –ú–∞—Å—Å–æ–≤—ã–µ –∑–∞–º–µ–Ω—ã
‚îî‚îÄ‚îÄ SKILL.md          # –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –í–ê–ñ–ù–û: unpack.py –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ—Ä–∂–∏—Ç split runs

–°–∫—Ä–∏–ø—Ç `unpack.py` **–†–ï–®–ê–ï–¢** –ø—Ä–æ–±–ª–µ–º—É —Ä–∞–∑–±–∏—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞:
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç —Å–æ—Å–µ–¥–Ω–∏–µ `<w:r>` –±–ª–æ–∫–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- Pretty-print –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç smart quotes –≤ XML entities

**Split runs ‚Äî –ù–ï –ø—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –æ—Ç —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞.**

## –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –ò–∑–º–µ–Ω–µ–Ω–∏–π | –°—Ç—Ä–∞—Ç–µ–≥–∏—è |
|-----------|-----------|
| 1-10 | –†—É—á–Ω–æ–π –ø–æ–∏—Å–∫/–∑–∞–º–µ–Ω–∞ –≤ XML –∏–ª–∏ sed |
| 10-50 | batch_replace.py |
| 50+ | batch_replace.py + mapping —Ñ–∞–π–ª |

## –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

- **–ó–ê–ü–†–ï–©–ï–ù–û:** python-docx, pandoc –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äî –æ–Ω–∏ –ª–æ–º–∞—é—Ç —Ç–∞–±–ª–∏—Ü—ã –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:** unpack ‚Üí edit XML ‚Üí pack
- **–ù–ï –û–¢–ö–ê–ó–´–í–ê–ô–°–Ø –æ—Ç XML –ø–æ–¥—Ö–æ–¥–∞** –∏–∑-–∑–∞:
  - Split runs ‚Üí unpack.py —É–∂–µ –º–µ—Ä–∂–∏—Ç –∏—Ö
  - –ë–æ–ª—å—à–æ–π XML ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π grep/sed, –Ω–µ —á–∏—Ç–∞–π —Ü–µ–ª–∏–∫–æ–º
  - –ú–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π batch_replace.py
  - –¢–∞–±–ª–∏—Ü—ã ‚Üí –º–µ–Ω—è–π —Ç–æ–ª—å–∫–æ `<w:t>` –≤–Ω—É—Ç—Ä–∏ —è—á–µ–µ–∫

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π Workflow

### –®–∞–≥ 1: –†–∞—Å–ø–∞–∫–æ–≤–∫–∞

```bash
# –°–æ–∑–¥–∞–π —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
mkdir -p /tmp/docx_work

# –†–∞—Å–ø–∞–∫—É–π –¥–æ–∫—É–º–µ–Ω—Ç
python PROJECT_SHPMNT_PROFIT/tools/unpack.py "–ø—É—Ç—å/–∫/–¥–æ–∫—É–º–µ–Ω—Ç—É.docx" /tmp/docx_work/unpacked/
```

–í—ã–≤–æ–¥:
```
üì¶ –†–∞—Å–ø–∞–∫–æ–≤–∫–∞: –¥–æ–∫—É–º–µ–Ω—Ç.docx
  üìÑ –û–±—Ä–∞–±–æ—Ç–∫–∞: word/document.xml
    ‚úì Merged runs: 847 ‚Üí 312
‚úÖ –†–∞—Å–ø–∞–∫–æ–≤–∞–Ω–æ –≤: /tmp/docx_work/unpacked/
   –¢–∞–±–ª–∏—Ü: 25, –ü–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤: 500
```

### –®–∞–≥ 2: –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞

```bash
# –°—Ç—Ä—É–∫—Ç—É—Ä–∞
ls -la /tmp/docx_work/unpacked/word/

# –ü–æ–∏—Å–∫ —Ç–µ–∫—Å—Ç–∞
grep -n "–∏—Å–∫–æ–º—ã–π —Ç–µ–∫—Å—Ç" /tmp/docx_work/unpacked/word/document.xml

# –ü–æ–¥—Å—á—ë—Ç –≤—Ö–æ–∂–¥–µ–Ω–∏–π
grep -c "–∏—Å–∫–æ–º—ã–π —Ç–µ–∫—Å—Ç" /tmp/docx_work/unpacked/word/document.xml

# –ö–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–∫—Ä—É–≥ —Å—Ç—Ä–æ–∫–∏ 500
sed -n '495,505p' /tmp/docx_work/unpacked/word/document.xml

# –ü–æ–¥—Å—á—ë—Ç —Ç–∞–±–ª–∏—Ü
grep -c "<w:tbl>" /tmp/docx_work/unpacked/word/document.xml
```

**–ü–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ –°–û–û–ë–©–ò –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:**
- –°–∫–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
- –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã/–∑–∞–≥–æ–ª–æ–≤–∫–∏
- –ß—Ç–æ –ø–ª–∞–Ω–∏—Ä—É–µ—à—å –∏–∑–º–µ–Ω–∏—Ç—å
- –°–∫–æ–ª—å–∫–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–π –Ω–∞–π–¥–µ–Ω–æ

**–°–ø—Ä–æ—Å–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –ø—Ä–∞–≤–∫–∞–º–∏ –µ—Å–ª–∏ –∑–∞–¥–∞—á–∞ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–∞—è.**

### –®–∞–≥ 3: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –í–∞—Ä–∏–∞–Ω—Ç A: –ú–∞–ª–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π (1-10)

–ò—Å–ø–æ–ª—å–∑—É–π sed –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–º–µ–Ω:

```bash
# –ü—Ä–æ—Å—Ç–∞—è –∑–∞–º–µ–Ω–∞ (macOS - –Ω—É–∂–µ–Ω '' –ø–æ—Å–ª–µ -i)
sed -i '' 's/<w:t>—Å—Ç–∞—Ä—ã–π —Ç–µ–∫—Å—Ç<\/w:t>/<w:t>–Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç<\/w:t>/g' /tmp/docx_work/unpacked/word/document.xml

# –° —Å–æ–∑–¥–∞–Ω–∏–µ–º –±—ç–∫–∞–ø–∞
sed -i '.bak' 's/<w:t>—Å—Ç–∞—Ä—ã–π —Ç–µ–∫—Å—Ç<\/w:t>/<w:t>–Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç<\/w:t>/g' /tmp/docx_work/unpacked/word/document.xml
```

#### –í–∞—Ä–∏–∞–Ω—Ç B: –ú–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π (10+)

**–°–æ–∑–¥–∞–π —Ñ–∞–π–ª replacements.py –≤ /tmp/:**

```python
#!/usr/bin/env python3
import sys
sys.path.insert(0, 'PROJECT_SHPMNT_PROFIT/tools')
from batch_replace import batch_replace

REPLACEMENTS = [
    ("race condition", "–∫–æ–Ω—Ñ–ª–∏–∫—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π"),
    ("deadlock", "–≤–∑–∞–∏–º–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞"),
    ("30 –¥–Ω–µ–π", "45 –¥–Ω–µ–π"),
    # ... –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–º–µ–Ω—ã
]

batch_replace(
    '/tmp/docx_work/unpacked/word/document.xml',
    REPLACEMENTS,
    use_tracked=False  # True –¥–ª—è Tracked Changes
)
```

**–ó–∞–ø—É—Å—Ç–∏:**
```bash
python /tmp/replacements.py
```

#### Tracked Changes (–¥–ª—è —Ä–µ–≤—å—é)

–ü—Ä–∏ `use_tracked=True` —Å–æ–∑–¥–∞—ë—Ç—Å—è:
```xml
<w:del w:id="1" w:author="–®–∞—Ö–æ–≤—Å–∫–∏–π –ê.–°." w:date="2026-01-29T12:00:00Z">
  <w:r><w:rPr>...</w:rPr><w:delText>—Å—Ç–∞—Ä—ã–π —Ç–µ–∫—Å—Ç</w:delText></w:r>
</w:del>
<w:ins w:id="2" w:author="–®–∞—Ö–æ–≤—Å–∫–∏–π –ê.–°." w:date="2026-01-29T12:00:00Z">
  <w:r><w:rPr>...</w:rPr><w:t>–Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç</w:t></w:r>
</w:ins>
```

**–ö–†–ò–¢–ò–ß–ù–û:**
- –í–Ω—É—Ç—Ä–∏ `<w:del>` –∏—Å–ø–æ–ª—å–∑—É–π `<w:delText>`, –Ω–µ `<w:t>`
- –ö–æ–ø–∏—Ä—É–π `<w:rPr>` —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –æ–±–∞ –±–ª–æ–∫–∞
- `batch_replace.py` –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –í–∞–ª–∏–¥–∞—Ü–∏—è XML (macOS)
xmllint --noout /tmp/docx_work/unpacked/word/document.xml && echo "‚úì XML –≤–∞–ª–∏–¥–Ω—ã–π"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–º–µ–Ω
grep -c "–Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç" /tmp/docx_work/unpacked/word/document.xml

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Å—Ç–∞—Ä–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –Ω–µ—Ç
grep -c "—Å—Ç–∞—Ä—ã–π —Ç–µ–∫—Å—Ç" /tmp/docx_work/unpacked/word/document.xml
```

### –®–∞–≥ 5: –£–ø–∞–∫–æ–≤–∫–∞

```bash
python PROJECT_SHPMNT_PROFIT/tools/pack.py /tmp/docx_work/unpacked/ "–ø—É—Ç—å/–∫/—Ä–µ–∑—É–ª—å—Ç–∞—Ç.docx" --original "–ø—É—Ç—å/–∫/–æ—Ä–∏–≥–∏–Ω–∞–ª.docx"
```

–í—ã–≤–æ–¥:
```
üì¶ –£–ø–∞–∫–æ–≤–∫–∞: /tmp/docx_work/unpacked/ ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç.docx
‚úÖ –°–æ–∑–¥–∞–Ω: —Ä–µ–∑—É–ª—å—Ç–∞—Ç.docx
   –†–∞–∑–º–µ—Ä: 108 KB
```

### –®–∞–≥ 6: –û—Ç—á—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —Å–æ–æ–±—â–∏:

1. ‚úÖ –ö–∞–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–Ω–µ—Å–µ–Ω—ã (—Å–ø–∏—Å–æ–∫)
2. üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: X —Ç–∏–ø–æ–≤ –∑–∞–º–µ–Ω, Y –≤—Ö–æ–∂–¥–µ–Ω–∏–π
3. üìÅ –ü—É—Ç—å –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
4. ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –µ—Å–ª–∏ –±—ã–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã

**–ü—Ä–∏–º–µ—Ä –æ—Ç—á—ë—Ç–∞:**
```
‚úÖ –ì–æ—Ç–æ–≤–æ! –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ FM-LS-PROFIT-v1.2.1.docx:

1. "race condition" ‚Üí "–∫–æ–Ω—Ñ–ª–∏–∫—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π" (5 –∑–∞–º–µ–Ω)
2. "deadlock" ‚Üí "–≤–∑–∞–∏–º–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞" (2 –∑–∞–º–µ–Ω—ã)
3. –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ–æ—Ä–º—É–ª–∞ –æ—Å—Ç–∞—Ç–∫–∞ –õ–° –≤ –ø. 2.4–∞
4. –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ SLA <100 —Ç.—Ä. –≤ –ø. 2.4
...

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: 32 —Ç–∏–ø–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π, 87 –≤—Ö–æ–∂–¥–µ–Ω–∏–π

üìÅ –†–µ–∑—É–ª—å—Ç–∞—Ç: PROJECT_SHPMNT_PROFIT/FM_DOCUMENTS/FM-LS-PROFIT-v1.2.1.docx

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –±–µ–∑ Tracked Changes (—Ç–∏—Ö–∞—è –∑–∞–º–µ–Ω–∞).
```

## –†–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

**–ù–ï —á–∏—Ç–∞–π –≤–µ—Å—å XML –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç.** –ò—Å–ø–æ–ª—å–∑—É–π:

```bash
# –ü–æ–∏—Å–∫ —Å –Ω–æ–º–µ—Ä–∞–º–∏ —Å—Ç—Ä–æ–∫
grep -n "—Ç–µ–∫—Å—Ç" /tmp/docx_work/unpacked/word/document.xml | head -20

# –ò–∑–≤–ª–µ—á—å —Å—Ç—Ä–æ–∫–∏ 1000-1020
sed -n '1000,1020p' /tmp/docx_work/unpacked/word/document.xml

# –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
wc -l /tmp/docx_work/unpacked/word/document.xml
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü

```xml
<w:tbl>
  <w:tblPr>...</w:tblPr>     <!-- –ù–ï –¢–†–û–ì–ê–ô -->
  <w:tblGrid>...</w:tblGrid> <!-- –ù–ï –¢–†–û–ì–ê–ô -->
  <w:tr>                     <!-- —Å—Ç—Ä–æ–∫–∞ -->
    <w:tc>                   <!-- —è—á–µ–π–∫–∞ -->
      <w:tcPr>...</w:tcPr>   <!-- –ù–ï –¢–†–û–ì–ê–ô -->
      <w:p>
        <w:r><w:t>–¢–ï–ö–°–¢</w:t></w:r>  <!-- ‚Üê –ú–û–ñ–ù–û –ú–ï–ù–Ø–¢–¨ -->
      </w:p>
    </w:tc>
  </w:tr>
</w:tbl>
```

**–ü—Ä–∞–≤–∏–ª–æ:** –º–µ–Ω—è–π –¢–û–õ–¨–ö–û `<w:t>` –≤–Ω—É—Ç—Ä–∏ —è—á–µ–µ–∫, –Ω–µ —Ç—Ä–æ–≥–∞–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã.

## –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ö–†–ò–¢–ò–ß–ù–û: –í—Å–µ–≥–¥–∞ –∫–æ–ø–∏—Ä—É–π `<w:rPr>`

–ü—Ä–∏ tracked changes –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∫–æ–ø–∏—Ä—É–π –±–ª–æ–∫ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞:

```xml
<!-- –û—Ä–∏–≥–∏–Ω–∞–ª —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º -->
<w:r>
  <w:rPr>
    <w:b/>           <!-- –∂–∏—Ä–Ω—ã–π -->
    <w:sz w:val="28"/> <!-- —Ä–∞–∑–º–µ—Ä -->
    <w:color w:val="FF0000"/> <!-- —Ü–≤–µ—Ç -->
  </w:rPr>
  <w:t>—Å—Ç–∞—Ä—ã–π —Ç–µ–∫—Å—Ç</w:t>
</w:r>

<!-- –ü–†–ê–í–ò–õ–¨–ù–û ‚Äî –∫–æ–ø–∏—Ä—É–µ–º –≤–µ—Å—å <w:rPr> -->
<w:del w:id="1" w:author="–®–∞—Ö–æ–≤—Å–∫–∏–π –ê.–°." w:date="...">
  <w:r>
    <w:rPr><w:b/><w:sz w:val="28"/><w:color w:val="FF0000"/></w:rPr>
    <w:delText>—Å—Ç–∞—Ä—ã–π —Ç–µ–∫—Å—Ç</w:delText>
  </w:r>
</w:del>
<w:ins w:id="2" w:author="–®–∞—Ö–æ–≤—Å–∫–∏–π –ê.–°." w:date="...">
  <w:r>
    <w:rPr><w:b/><w:sz w:val="28"/><w:color w:val="FF0000"/></w:rPr>
    <w:t>–Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç</w:t>
  </w:r>
</w:ins>
```

`batch_replace.py` –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
# batch_replace.py —Å–æ–∑–¥–∞—ë—Ç –±—ç–∫–∞–ø –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
cp /tmp/docx_work/unpacked/word/document.xml.backup /tmp/docx_work/unpacked/word/document.xml

# –ò–ª–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ DOCX
python PROJECT_SHPMNT_PROFIT/tools/unpack.py "–æ—Ä–∏–≥–∏–Ω–∞–ª.docx" /tmp/docx_work/unpacked/
```

## Smart Quotes

–ü—Ä–∏ —Ä—É—á–Ω–æ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π XML entities:
- `&#x2019;` ‚Äî –∞–ø–æ—Å—Ç—Ä–æ—Ñ '
- `&#x201C;` ‚Äî –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è "
- `&#x201D;` ‚Äî –∑–∞–∫—Ä—ã–≤–∞—é—â–∞—è "

## –§–æ—Ä–º—É–ª—ã

**–ù–ï —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `<m:oMath>` –±–ª–æ–∫–∏** ‚Äî —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞. –°–æ–æ–±—â–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á—Ç–æ —Ñ–æ—Ä–º—É–ª—ã –ª—É—á—à–µ –ø—Ä–∞–≤–∏—Ç—å –≤ Word.

## –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ pack.py

| –û—à–∏–±–∫–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|
| durableId overflow | –ê–≤—Ç–æ-–∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è |
| Tag imbalance | –ü—Ä–æ–≤–µ—Ä—å –ø–∞—Ä–Ω–æ—Å—Ç—å —Ç–µ–≥–æ–≤ |
| Missing xml:space | –ê–≤—Ç–æ-–¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è |

## –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥

```bash
# –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª (FM-LS-PROFIT –ø—Ä–æ–µ–∫—Ç)
python PROJECT_SHPMNT_PROFIT/tools/unpack.py input.docx /tmp/docx_work/unpacked/
python /tmp/replacements.py
python PROJECT_SHPMNT_PROFIT/tools/pack.py /tmp/docx_work/unpacked/ output.docx --original input.docx

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–º–µ–Ω–æ–π
grep -c "–∏—Å–∫–æ–º—ã–π —Ç–µ–∫—Å—Ç" /tmp/docx_work/unpacked/word/document.xml

# Dry run —á–µ—Ä–µ–∑ sed (–ø–æ–∫–∞–∑–∞—Ç—å —á—Ç–æ –±—É–¥–µ—Ç –∑–∞–º–µ–Ω–µ–Ω–æ)
grep "—Å—Ç–∞—Ä—ã–π —Ç–µ–∫—Å—Ç" /tmp/docx_work/unpacked/word/document.xml
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ï—Å–ª–∏ `pack.py` –≤—ã–¥–∞—ë—Ç –æ—à–∏–±–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
1. –ü—Ä–æ—á–∏—Ç–∞–π —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
2. –ò—Å–ø—Ä–∞–≤—å XML (–æ–±—ã—á–Ω–æ –ø—Ä–æ–±–ª–µ–º–∞ —Å ID –∏–ª–∏ –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–º–∏ —Ç–µ–≥–∞–º–∏)
3. –ü–æ–ø—Ä–æ–±—É–π —É–ø–∞–∫–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞

–ï—Å–ª–∏ –Ω–µ –Ω–∞—Ö–æ–¥–∏—à—å —Ç–µ–∫—Å—Ç –¥–ª—è –∑–∞–º–µ–Ω—ã:
1. –ü–æ–∏—â–∏ —Å grep: `grep -n "–∏—Å–∫–æ–º—ã–π —Ç–µ–∫—Å—Ç" /tmp/docx_work/unpacked/word/document.xml`
2. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ unpack.py —Å–ª–∏–ª runs (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –≤—ã–≤–æ–¥–µ "Merged runs")
3. –°–æ–æ–±—â–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –µ—Å–ª–∏ –Ω–µ –Ω–∞—à—ë–ª

## –¢–∏–ø–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏

### "–°–¥–µ–ª–∞–π —Ä–µ–≤—å—é –¥–æ–∫—É–º–µ–Ω—Ç–∞"
1. –†–∞—Å–ø–∞–∫—É–π
2. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
3. –°–ø—Ä–æ—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á—Ç–æ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å/–∏—Å–ø—Ä–∞–≤–∏—Ç—å
4. –í–Ω–µ—Å–∏ –ø—Ä–∞–≤–∫–∏ —Å tracked changes (`use_tracked=True`)
5. –£–ø–∞–∫—É–π –∏ –æ—Ç—á–∏—Ç–∞–π—Å—è

### "–ó–∞–º–µ–Ω–∏ X –Ω–∞ Y –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ"
1. –†–∞—Å–ø–∞–∫—É–π
2. –ù–∞–π–¥–∏ –≤—Å–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è X
3. –°–æ–æ–±—â–∏ —Å–∫–æ–ª—å–∫–æ –Ω–∞–π–¥–µ–Ω–æ, —Å–ø—Ä–æ—Å–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
4. –ó–∞–º–µ–Ω–∏ (–∏—Å–ø–æ–ª—å–∑—É–π batch_replace.py –µ—Å–ª–∏ >10 –∑–∞–º–µ–Ω)
5. –£–ø–∞–∫—É–π –∏ –æ—Ç—á–∏—Ç–∞–π—Å—è

### "–ò—Å–ø—Ä–∞–≤—å –æ—à–∏–±–∫–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ"
1. –†–∞—Å–ø–∞–∫—É–π
2. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–µ–∫—Å—Ç
3. –ü–æ–∫–∞–∂–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏, —Å–ø—Ä–æ—Å–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
4. –ò—Å–ø—Ä–∞–≤—å (batch_replace.py —Å `use_tracked=False`)
5. –£–ø–∞–∫—É–π –∏ –æ—Ç—á–∏—Ç–∞–π—Å—è

### "–ü—Ä–∏–º–µ–Ω–∏—Ç—å 32 –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ AGREED-SOLUTIONS.md"
1. –†–∞—Å–ø–∞–∫—É–π
2. –°–æ–∑–¥–∞–π replacements.py —Å–æ —Å–ø–∏—Å–∫–æ–º –≤—Å–µ—Ö 32 –∑–∞–º–µ–Ω
3. –ó–∞–ø—É—Å—Ç–∏ batch_replace.py
4. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
5. –£–ø–∞–∫—É–π –∏ –æ—Ç—á–∏—Ç–∞–π—Å—è
