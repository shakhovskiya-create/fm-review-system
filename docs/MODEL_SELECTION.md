# Выбор моделей для агентов

> Обоснование выбора моделей для каждого субагента системы.

---

## Текущее распределение

| Агент | Модель | Обоснование |
|-------|--------|-------------|
| Agent 0 (Creator) | `opus` | Создание ФМ требует глубокого понимания бизнес-процессов, интервью, структурирования |
| Agent 1 (Architect) | `opus` | Критический агент: полный аудит бизнес-логики + совместимость 1С. Высший приоритет |
| Agent 2 (Simulator) | `opus` | Симуляция ролей требует "вживания" в роль, понимания UX-контекста |
| Agent 3 (Defender) | `opus` | Анализ замечаний бизнеса: нужен глубокий reasoning для классификации A-I |
| Agent 4 (QA Tester) | `sonnet` | Генерация тест-кейсов - структурированная задача, sonnet справляется |
| Agent 5 (Tech Architect) | `opus` | Проектирование архитектуры 1С: сложные решения, ТЗ, ARC-документы |
| Agent 6 (Presenter) | `sonnet` | Синтез отчетов и презентаций - форматирование, не глубокий анализ |
| Agent 7 (Publisher) | `sonnet` | Работа с Confluence API: PUT/GET, XHTML. Технические операции |
| Agent 8 (BPMN Designer) | `sonnet` | Генерация drawio-диаграмм - структурированная задача |

## Принцип выбора

```
opus  → Глубокий анализ, принятие решений, творческие задачи
sonnet → Структурированные задачи, форматирование, API-операции
haiku  → Не используется (субагенты требуют контекст ФМ)
```

**Правило:** Агенты с `disallowedTools: Write, Edit` (read-only) могут быть переведены на `sonnet` для экономии, если качество не падает.

## Когда менять модель

- **Повысить до opus:** агент регулярно пропускает проблемы или генерирует поверхностные результаты
- **Понизить до sonnet:** задача агента стала более шаблонной, качество не страдает
- **haiku:** только для вспомогательных одноразовых запросов (не для субагентов с полным контекстом ФМ)

## Стоимость

| Модель | Относительная стоимость | Скорость |
|--------|------------------------|----------|
| opus | Базовая (1x) | Медленная |
| sonnet | ~0.3x | Быстрая |
| haiku | ~0.05x | Очень быстрая |

Текущее соотношение: 5 opus + 4 sonnet. При 9 агентах в полном пайплайне - оптимальный баланс качества и стоимости.
