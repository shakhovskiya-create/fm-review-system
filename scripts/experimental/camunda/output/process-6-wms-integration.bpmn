<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL"
                  xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
                  xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
                  xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns:zeebe="http://camunda.org/schema/zeebe/1.0"
                  id="Definitions_1"
                  targetNamespace="http://bpmn.io/schema/bpmn"
                  exporter="fm-review-system"
                  exporterVersion="1.0">
  <bpmn:error id="Error_end_cancel" name="Отменено" errorCode="END_CANCEL" />
  <bpmn:collaboration id="Collaboration_1">
    <bpmn:participant id="Participant_1" name="Интеграция с WMS" processRef="Process_integraciya_s_wms" />
  </bpmn:collaboration>
  <bpmn:process id="Process_integraciya_s_wms" name="Интеграция с WMS" isExecutable="true">
    <bpmn:laneSet id="LaneSet_1">
      <bpmn:lane id="Lane_system" name="1С:УТ">
        <bpmn:flowNodeRef>start</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>t1</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>t_pnr</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>t6</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>x2</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>t7</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>t11</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>end_ok</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>end_cancel</bpmn:flowNodeRef>
      </bpmn:lane>
      <bpmn:lane id="Lane_wms" name="WMS">
        <bpmn:flowNodeRef>t2</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>x1</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>t4</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>t5</bpmn:flowNodeRef>
      </bpmn:lane>
      <bpmn:lane id="Lane_warehouse" name="Специалист склада">
        <bpmn:flowNodeRef>t3</bpmn:flowNodeRef>
      </bpmn:lane>
      <bpmn:lane id="Lane_manager" name="Менеджер">
        <bpmn:flowNodeRef>t8</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>x3</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>t9</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>t10</bpmn:flowNodeRef>
      </bpmn:lane>
    </bpmn:laneSet>
    <bpmn:startEvent id="start" name="">
      <bpmn:outgoing>Flow_start_t1</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:task id="t1" name="Отправка JSON с заказом в WMS">
      <bpmn:incoming>Flow_start_t1</bpmn:incoming>
      <bpmn:outgoing>Flow_t1_t_pnr</bpmn:outgoing>
    </bpmn:task>
    <bpmn:task id="t_pnr" name="Установка флага ПереданНаСклад (точка невозврата)">
      <bpmn:incoming>Flow_t1_t_pnr</bpmn:incoming>
      <bpmn:outgoing>Flow_t_pnr_t2</bpmn:outgoing>
    </bpmn:task>
    <bpmn:task id="t2" name="Получение задания на отборку">
      <bpmn:incoming>Flow_t_pnr_t2</bpmn:incoming>
      <bpmn:outgoing>Flow_t2_t3</bpmn:outgoing>
    </bpmn:task>
    <bpmn:task id="t3" name="Отборка товара">
      <bpmn:incoming>Flow_t2_t3</bpmn:incoming>
      <bpmn:outgoing>Flow_t3_x1</bpmn:outgoing>
    </bpmn:task>
    <bpmn:exclusiveGateway id="x1" name="X" default="Flow_x1_t5">
      <bpmn:incoming>Flow_t3_x1</bpmn:incoming>
      <bpmn:outgoing>Flow_x1_t4</bpmn:outgoing>
      <bpmn:outgoing>Flow_x1_t5</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:task id="t4" name="Полная отборка (факт = план)">
      <bpmn:incoming>Flow_x1_t4</bpmn:incoming>
      <bpmn:outgoing>Flow_t4_t11</bpmn:outgoing>
    </bpmn:task>
    <bpmn:task id="t5" name="Частичная отборка (факт &lt; план)">
      <bpmn:incoming>Flow_x1_t5</bpmn:incoming>
      <bpmn:outgoing>Flow_t5_t6</bpmn:outgoing>
    </bpmn:task>
    <bpmn:task id="t6" name="Пересчет рентабельности по факту">
      <bpmn:incoming>Flow_t5_t6</bpmn:incoming>
      <bpmn:outgoing>Flow_t6_x2</bpmn:outgoing>
    </bpmn:task>
    <bpmn:exclusiveGateway id="x2" name="X" default="Flow_x2_t8">
      <bpmn:incoming>Flow_t6_x2</bpmn:incoming>
      <bpmn:outgoing>Flow_x2_t7</bpmn:outgoing>
      <bpmn:outgoing>Flow_x2_t8</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:task id="t7" name="Отгрузка по факту">
      <bpmn:incoming>Flow_x2_t7</bpmn:incoming>
      <bpmn:outgoing>Flow_t7_t11</bpmn:outgoing>
    </bpmn:task>
    <bpmn:task id="t8" name="Запрос решения менеджера (SLA 2 часа)">
      <bpmn:incoming>Flow_x2_t8</bpmn:incoming>
      <bpmn:outgoing>Flow_t8_x3</bpmn:outgoing>
    </bpmn:task>
    <bpmn:exclusiveGateway id="x3" name="X" default="Flow_x3_t10">
      <bpmn:incoming>Flow_t8_x3</bpmn:incoming>
      <bpmn:outgoing>Flow_x3_t9</bpmn:outgoing>
      <bpmn:outgoing>Flow_x3_t10</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:task id="t9" name="Подтвердить отгрузку">
      <bpmn:incoming>Flow_x3_t9</bpmn:incoming>
      <bpmn:outgoing>Flow_t9_t11</bpmn:outgoing>
    </bpmn:task>
    <bpmn:task id="t10" name="Отмена (авто через 2 ч)">
      <bpmn:incoming>Flow_x3_t10</bpmn:incoming>
      <bpmn:outgoing>Flow_t10_end_cancel</bpmn:outgoing>
    </bpmn:task>
    <bpmn:task id="t11" name="Создание и проведение РТУ">
      <bpmn:incoming>Flow_t4_t11</bpmn:incoming>
      <bpmn:incoming>Flow_t7_t11</bpmn:incoming>
      <bpmn:incoming>Flow_t9_t11</bpmn:incoming>
      <bpmn:outgoing>Flow_t11_end_ok</bpmn:outgoing>
    </bpmn:task>
    <bpmn:endEvent id="end_ok" name="РТУ проведен">
      <bpmn:incoming>Flow_t11_end_ok</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:endEvent id="end_cancel" name="Отменено">
      <bpmn:incoming>Flow_t10_end_cancel</bpmn:incoming>
      <bpmn:errorEventDefinition id="ErrorDef_end_cancel" errorRef="Error_end_cancel" />
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_start_t1" sourceRef="start" targetRef="t1" />
    <bpmn:sequenceFlow id="Flow_t1_t_pnr" sourceRef="t1" targetRef="t_pnr" />
    <bpmn:sequenceFlow id="Flow_t_pnr_t2" sourceRef="t_pnr" targetRef="t2" />
    <bpmn:sequenceFlow id="Flow_t2_t3" sourceRef="t2" targetRef="t3" />
    <bpmn:sequenceFlow id="Flow_t3_x1" sourceRef="t3" targetRef="x1" />
    <bpmn:sequenceFlow id="Flow_x1_t4" name="полная" sourceRef="x1" targetRef="t4">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=полная</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_x1_t5" name="частичная" sourceRef="x1" targetRef="t5" />
    <bpmn:sequenceFlow id="Flow_t4_t11" sourceRef="t4" targetRef="t11" />
    <bpmn:sequenceFlow id="Flow_t5_t6" sourceRef="t5" targetRef="t6" />
    <bpmn:sequenceFlow id="Flow_t6_x2" sourceRef="t6" targetRef="x2" />
    <bpmn:sequenceFlow id="Flow_x2_t7" name="не ухудшилась" sourceRef="x2" targetRef="t7">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=не ухудшилась</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_x2_t8" name="ухудшилась" sourceRef="x2" targetRef="t8" />
    <bpmn:sequenceFlow id="Flow_t7_t11" sourceRef="t7" targetRef="t11" />
    <bpmn:sequenceFlow id="Flow_t8_x3" sourceRef="t8" targetRef="x3" />
    <bpmn:sequenceFlow id="Flow_x3_t9" name="отгрузить" sourceRef="x3" targetRef="t9">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=отгрузить</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_x3_t10" name="отменить" sourceRef="x3" targetRef="t10" />
    <bpmn:sequenceFlow id="Flow_t9_t11" sourceRef="t9" targetRef="t11" />
    <bpmn:sequenceFlow id="Flow_t10_end_cancel" sourceRef="t10" targetRef="end_cancel" />
    <bpmn:sequenceFlow id="Flow_t11_end_ok" sourceRef="t11" targetRef="end_ok" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Collaboration_1">
      <bpmndi:BPMNShape id="Participant_1_di" bpmnElement="Participant_1" isHorizontal="true">
        <dc:Bounds x="100" y="60" width="2900" height="1000" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_system_di" bpmnElement="Lane_system" isHorizontal="true">
        <dc:Bounds x="130" y="60" width="2870" height="280" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_wms_di" bpmnElement="Lane_wms" isHorizontal="true">
        <dc:Bounds x="130" y="340" width="2870" height="280" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_warehouse_di" bpmnElement="Lane_warehouse" isHorizontal="true">
        <dc:Bounds x="130" y="620" width="2870" height="160" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_manager_di" bpmnElement="Lane_manager" isHorizontal="true">
        <dc:Bounds x="130" y="780" width="2870" height="280" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="start_di" bpmnElement="start">
        <dc:Bounds x="200" y="160" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="t1_di" bpmnElement="t1">
        <dc:Bounds x="380" y="160" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="t_pnr_di" bpmnElement="t_pnr">
        <dc:Bounds x="560" y="160" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="t2_di" bpmnElement="t2">
        <dc:Bounds x="740" y="440" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="t3_di" bpmnElement="t3">
        <dc:Bounds x="920" y="660" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="x1_di" bpmnElement="x1">
        <dc:Bounds x="1100" y="440" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="t4_di" bpmnElement="t4">
        <dc:Bounds x="1280" y="380" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="t5_di" bpmnElement="t5">
        <dc:Bounds x="1280" y="500" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="t6_di" bpmnElement="t6">
        <dc:Bounds x="1460" y="160" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="x2_di" bpmnElement="x2">
        <dc:Bounds x="1640" y="160" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="t7_di" bpmnElement="t7">
        <dc:Bounds x="1820" y="160" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="t8_di" bpmnElement="t8">
        <dc:Bounds x="1820" y="880" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="x3_di" bpmnElement="x3">
        <dc:Bounds x="2000" y="880" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="t9_di" bpmnElement="t9">
        <dc:Bounds x="2180" y="820" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="t10_di" bpmnElement="t10">
        <dc:Bounds x="2180" y="940" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="t11_di" bpmnElement="t11">
        <dc:Bounds x="2360" y="100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="end_ok_di" bpmnElement="end_ok">
        <dc:Bounds x="2540" y="160" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="end_cancel_di" bpmnElement="end_cancel">
        <dc:Bounds x="2360" y="220" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_start_t1_di" bpmnElement="Flow_start_t1">
        <di:waypoint x="236" y="178" />
        <di:waypoint x="308" y="178" />
        <di:waypoint x="308" y="200" />
        <di:waypoint x="380" y="200" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_t1_t_pnr_di" bpmnElement="Flow_t1_t_pnr">
        <di:waypoint x="480" y="200" />
        <di:waypoint x="560" y="200" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_t_pnr_t2_di" bpmnElement="Flow_t_pnr_t2">
        <di:waypoint x="660" y="200" />
        <di:waypoint x="700" y="200" />
        <di:waypoint x="700" y="480" />
        <di:waypoint x="740" y="480" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_t2_t3_di" bpmnElement="Flow_t2_t3">
        <di:waypoint x="840" y="480" />
        <di:waypoint x="880" y="480" />
        <di:waypoint x="880" y="700" />
        <di:waypoint x="920" y="700" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_t3_x1_di" bpmnElement="Flow_t3_x1">
        <di:waypoint x="1020" y="700" />
        <di:waypoint x="1060" y="700" />
        <di:waypoint x="1060" y="465" />
        <di:waypoint x="1100" y="465" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_x1_t4_di" bpmnElement="Flow_x1_t4">
        <di:waypoint x="1150" y="465" />
        <di:waypoint x="1215" y="465" />
        <di:waypoint x="1215" y="420" />
        <di:waypoint x="1280" y="420" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_x1_t5_di" bpmnElement="Flow_x1_t5">
        <di:waypoint x="1150" y="465" />
        <di:waypoint x="1215" y="465" />
        <di:waypoint x="1215" y="540" />
        <di:waypoint x="1280" y="540" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_t4_t11_di" bpmnElement="Flow_t4_t11">
        <di:waypoint x="1380" y="420" />
        <di:waypoint x="1870" y="420" />
        <di:waypoint x="1870" y="140" />
        <di:waypoint x="2360" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_t5_t6_di" bpmnElement="Flow_t5_t6">
        <di:waypoint x="1380" y="540" />
        <di:waypoint x="1420" y="540" />
        <di:waypoint x="1420" y="200" />
        <di:waypoint x="1460" y="200" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_t6_x2_di" bpmnElement="Flow_t6_x2">
        <di:waypoint x="1560" y="200" />
        <di:waypoint x="1600" y="200" />
        <di:waypoint x="1600" y="185" />
        <di:waypoint x="1640" y="185" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_x2_t7_di" bpmnElement="Flow_x2_t7">
        <di:waypoint x="1690" y="185" />
        <di:waypoint x="1755" y="185" />
        <di:waypoint x="1755" y="200" />
        <di:waypoint x="1820" y="200" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_x2_t8_di" bpmnElement="Flow_x2_t8">
        <di:waypoint x="1690" y="185" />
        <di:waypoint x="1755" y="185" />
        <di:waypoint x="1755" y="920" />
        <di:waypoint x="1820" y="920" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_t7_t11_di" bpmnElement="Flow_t7_t11">
        <di:waypoint x="1920" y="200" />
        <di:waypoint x="2140" y="200" />
        <di:waypoint x="2140" y="140" />
        <di:waypoint x="2360" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_t8_x3_di" bpmnElement="Flow_t8_x3">
        <di:waypoint x="1920" y="920" />
        <di:waypoint x="1960" y="920" />
        <di:waypoint x="1960" y="905" />
        <di:waypoint x="2000" y="905" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_x3_t9_di" bpmnElement="Flow_x3_t9">
        <di:waypoint x="2050" y="905" />
        <di:waypoint x="2115" y="905" />
        <di:waypoint x="2115" y="860" />
        <di:waypoint x="2180" y="860" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_x3_t10_di" bpmnElement="Flow_x3_t10">
        <di:waypoint x="2050" y="905" />
        <di:waypoint x="2115" y="905" />
        <di:waypoint x="2115" y="980" />
        <di:waypoint x="2180" y="980" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_t9_t11_di" bpmnElement="Flow_t9_t11">
        <di:waypoint x="2280" y="860" />
        <di:waypoint x="2320" y="860" />
        <di:waypoint x="2320" y="140" />
        <di:waypoint x="2360" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_t10_end_cancel_di" bpmnElement="Flow_t10_end_cancel">
        <di:waypoint x="2280" y="980" />
        <di:waypoint x="2320" y="980" />
        <di:waypoint x="2320" y="238" />
        <di:waypoint x="2360" y="238" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_t11_end_ok_di" bpmnElement="Flow_t11_end_ok">
        <di:waypoint x="2460" y="140" />
        <di:waypoint x="2500" y="140" />
        <di:waypoint x="2500" y="178" />
        <di:waypoint x="2540" y="178" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>