# Обязательное правило: Smoke-тесты перед сдачей

**НЕ сдавать результат без smoke-тестов.** Это абсолютное требование.

## Когда

После ЛЮБЫХ изменений в инфраструктуре (скрипты, хуки, конфиги, зависимости) — перед тем как сообщить пользователю "готово".

## Что проверять

1. **Изменённые скрипты** — запустить с реальными параметрами, проверить exit code
2. **pytest** — полный прогон `pytest tests/ -x -q`, 0 failures
3. **load-secrets.sh** — секреты загружаются из Infisical (не .env fallback)
4. **check-secrets.sh --verbose** — все ключи на месте
5. **CI на GitHub** — после push дождаться `gh run watch`, убедиться что зелёный

## Как

- Реальный запуск, не "должно работать"
- Проверить exit code: `echo $?`
- Для скриптов с побочными эффектами: `--dry-run`, `--help`, или безопасные параметры
- При ошибке — исправить и повторить, не сдавать с падающими тестами

## CI — обязательная проверка после push

После каждого `git push` — дождаться результата CI:
```bash
gh run watch --exit-status
```
Если CI красный — исправить, закоммитить, запушить, снова дождаться зелёного.
**НЕ сообщать "готово" пока CI не зелёный.**

## Минимальный чеклист

```
[ ] Изменённые скрипты запущены, exit 0
[ ] pytest — 0 failures
[ ] Секреты — из Infisical
[ ] git push + CI зелёный
```
